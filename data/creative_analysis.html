<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í¥ëÍ≥† ÏÜåÏû¨Î≥Ñ Î∂ÑÏÑù - ÎßàÏºÄÌåÖ ÎåÄÏãúÎ≥¥Îìú</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Berry Theme Colors */
            --primary-main: #673ab7;
            --primary-light: #ede7f6;
            --primary-dark: #5e35b1;
            --secondary-main: #2196f3;
            --secondary-light: #e3f2fd;
            --success-main: #00c853;
            --success-light: #b9f6ca;
            --warning-main: #ffab00;
            --warning-light: #fff8e1;
            --error-main: #ff1744;
            --error-light: #ffeaea;
            --grey-50: #fafafa;
            --grey-100: #f5f5f5;
            --grey-200: #eeeeee;
            --grey-300: #e0e0e0;
            --grey-500: #9e9e9e;
            --grey-700: #616161;
            --grey-900: #212121;
            --paper: #ffffff;
            --background: #f8fafc;
            --sidebar-bg: #ffffff;
            --sidebar-width: 260px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background);
            color: var(--grey-900);
            line-height: 1.5;
        }

        /* Î†àÏù¥ÏïÑÏõÉ Íµ¨Ï°∞ */
        .app-wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--sidebar-bg);
            border-right: 1px solid var(--grey-200);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid var(--grey-200);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .sidebar-logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-main) 0%, var(--primary-dark) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-logo-icon svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .sidebar-logo-text {
            font-size: 18px;
            font-weight: 700;
            color: var(--grey-900);
        }

        .sidebar-logo-subtitle {
            font-size: 11px;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Simplebar Ïä§ÌÉÄÏùº ÎûòÌçº */
        .simplebar-content-wrapper {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .simplebar-content-wrapper::-webkit-scrollbar {
            width: 6px;
        }

        .simplebar-content-wrapper::-webkit-scrollbar-track {
            background: transparent;
        }

        .simplebar-content-wrapper::-webkit-scrollbar-thumb {
            background: var(--grey-300);
            border-radius: 3px;
        }

        .sidebar-content {
            padding: 16px 12px;
        }

        /* ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Í∑∏Î£π */
        .nav-group {
            margin-bottom: 16px;
        }

        .nav-group-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 8px 16px;
            margin-bottom: 4px;
        }

        /* ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏïÑÏù¥ÌÖú */
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            color: var(--grey-700);
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .nav-item:hover {
            background: var(--grey-100);
            color: var(--primary-main);
        }

        .nav-item.active {
            background: var(--primary-light);
            color: var(--primary-main);
        }

        .nav-item-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-item-icon svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .nav-item-text {
            flex: 1;
        }

        /* Î©îÏù∏ Ïª®ÌÖêÏ∏† ÏòÅÏó≠ */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 24px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Ìó§Îçî */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--grey-900);
            margin: 0;
        }

        .header-subtitle {
            font-size: 14px;
            color: var(--grey-500);
            margin-top: 4px;
        }

        /* Ïπ¥Îìú Í≥µÌÜµ Ïä§ÌÉÄÏùº */
        .card {
            background: var(--paper);
            border-radius: 12px;
            box-shadow: 0 2px 14px 0 rgba(32, 40, 45, 0.08);
            transition: box-shadow 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 4px 20px 0 rgba(32, 40, 45, 0.12);
        }

        /* ÌïÑÌÑ∞ ÏÑπÏÖò */
        .filter-section {
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .filter-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-header::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        .filter-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .filter-section-header .filter-header {
            margin-bottom: 0;
        }

        .reset-btn {
            padding: 8px 16px;
            border: none;
            background: var(--paper);
            color: var(--grey-700);
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .reset-btn:hover {
            background: var(--primary-light);
            color: var(--primary-main);
        }

        .reset-btn:active {
            transform: scale(0.97);
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
        }

        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 160px;
            flex: 1;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 500;
            color: var(--grey-700);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px 14px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: var(--paper);
            color: var(--grey-900);
            transition: all 0.2s ease;
        }

        .filter-group select:hover,
        .filter-group input:hover {
            border-color: var(--primary-main);
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        /* ÎÇ†Ïßú Î≤îÏúÑ ÏÑ†ÌÉù */
        .date-range {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .date-range input[type="date"] {
            padding: 10px 14px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: var(--paper);
            color: var(--grey-900);
            transition: all 0.2s ease;
        }

        .date-range input[type="date"]:hover {
            border-color: var(--primary-main);
        }

        .date-range input[type="date"]:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .date-range span {
            color: var(--grey-500);
            font-weight: 500;
        }

        /* ÏÜåÏû¨ Í∑∏Î¶¨Îìú */
        .creative-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        /* ÏÜåÏû¨ Ïπ¥Îìú */
        .creative-card {
            border-radius: 16px;
            overflow: hidden;
        }

        .creative-image-wrapper {
            position: relative;
            width: 100%;
            padding-top: 100%; /* 1:1 ÎπÑÏú® */
            background: var(--grey-100);
            overflow: hidden;
        }

        .creative-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .creative-card:hover .creative-image {
            transform: scale(1.05);
        }

        .creative-image-link {
            display: block;
            text-decoration: none;
            position: relative;
        }

        .creative-image-link:hover::after {
            content: 'ÏõêÎ≥∏ Î≥¥Í∏∞';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            pointer-events: none;
        }

        .creative-image-link .creative-image-wrapper {
            cursor: pointer;
        }

        .creative-placeholder {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--grey-500);
            text-align: center;
        }

        .creative-placeholder svg {
            width: 48px;
            height: 48px;
            fill: var(--grey-300);
            margin-bottom: 8px;
        }

        .creative-info {
            padding: 20px;
        }

        .creative-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .creative-name.clickable {
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .creative-name.clickable:hover {
            color: var(--primary-main);
            text-decoration: underline;
        }

        .creative-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .creative-metric {
            display: flex;
            flex-direction: column;
        }

        .metric-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .metric-value {
            font-size: 16px;
            font-weight: 700;
            color: var(--grey-900);
        }

        .metric-value.positive {
            color: var(--success-main);
        }

        .metric-value.negative {
            color: var(--error-main);
        }

        /* ÏöîÏïΩ Ïπ¥Îìú */
        .summary-section {
            margin-bottom: 24px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
        }

        .summary-card {
            padding: 20px;
            border-radius: 12px;
        }

        .summary-card h3 {
            font-size: 11px;
            font-weight: 600;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .summary-card .value {
            font-size: 24px;
            font-weight: 700;
            color: var(--grey-900);
        }

        .summary-card .unit {
            font-size: 11px;
            color: var(--grey-500);
            margin-top: 4px;
        }

        /* Î°úÎî© */
        .loading {
            text-align: center;
            padding: 60px 40px;
            color: var(--grey-500);
        }

        /* Îπà ÏÉÅÌÉú */
        .empty-state {
            text-align: center;
            padding: 80px 40px;
            color: var(--grey-500);
        }

        .empty-state svg {
            width: 64px;
            height: 64px;
            fill: var(--grey-300);
            margin-bottom: 16px;
        }

        .empty-state h3 {
            font-size: 18px;
            font-weight: 600;
            color: var(--grey-700);
            margin-bottom: 8px;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 1400px) {
            .summary-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 16px;
            }

            .creative-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-row {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .summary-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--paper);
            border-radius: 16px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--grey-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--grey-900);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--grey-500);
            padding: 4px;
            line-height: 1;
        }

        .modal-close:hover {
            color: var(--grey-900);
        }

        .modal-body {
            padding: 24px;
        }

        /* Î™®Îã¨ KPI Í∑∏Î¶¨Îìú */
        .modal-kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .modal-kpi-card {
            background: var(--grey-50);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }

        .modal-kpi-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .modal-kpi-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--grey-900);
        }

        /* Î™®Îã¨ Ï∞®Ìä∏ */
        .modal-chart-section {
            margin-top: 24px;
        }

        .modal-chart-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 16px;
        }

        .modal-data-label-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border: none;
            background: var(--paper);
            color: var(--grey-700);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .modal-data-label-toggle:hover {
            background: var(--primary-light);
            color: var(--primary-main);
        }

        .modal-data-label-toggle.active {
            background: var(--primary-main);
            color: white;
            box-shadow: 0 4px 12px rgba(103, 58, 183, 0.4);
        }

        .modal-data-label-toggle .toggle-checkbox {
            font-size: 14px;
        }

        .modal-chart {
            width: 100%;
            height: 300px;
            background: var(--grey-50);
            border-radius: 12px;
            padding: 16px;
        }

        @media (max-width: 768px) {
            .modal-kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Î™®Îã¨ Î∑∞ ÌÉÄÏûÖ Î≤ÑÌäº */
        .modal-view-type-section {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .modal-view-btn {
            padding: 8px 20px;
            border: 1px solid var(--grey-300);
            background: var(--paper);
            color: var(--grey-700);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .modal-view-btn:hover {
            border-color: var(--primary-main);
            color: var(--primary-main);
        }

        .modal-view-btn.active {
            background: var(--primary-main);
            color: white;
            border-color: var(--primary-main);
        }

        /* Î™®Îã¨ Ï∞®Ìä∏ Ï≤¥ÌÅ¨Î∞ïÏä§ */
        .modal-chart-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .modal-chart-toggle-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .modal-chart-toggle-group .data-label-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border: none;
            background: var(--paper);
            color: var(--grey-700);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .modal-chart-toggle-group .data-label-toggle:hover {
            background: var(--primary-light);
            color: var(--primary-main);
        }

        .modal-chart-toggle-group .data-label-toggle.active {
            background: var(--primary-main);
            color: white;
            box-shadow: 0 4px 12px rgba(103, 58, 183, 0.4);
        }

        .modal-chart-toggle-group .data-label-toggle .toggle-checkbox {
            font-size: 14px;
        }

        /* Î™®Îã¨ ÌÖåÏù¥Î∏î */
        .modal-table-section {
            margin-top: 24px;
        }

        .modal-table-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 16px;
        }

        .modal-table-container {
            background: var(--grey-50);
            border-radius: 12px;
            overflow: hidden;
        }

        .modal-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .modal-table th {
            background: var(--grey-100);
            padding: 12px 16px;
            text-align: right;
            font-weight: 600;
            color: var(--grey-700);
            border-bottom: 1px solid var(--grey-200);
        }

        .modal-table th:first-child {
            text-align: left;
        }

        .modal-table td {
            padding: 12px 16px;
            text-align: right;
            border-bottom: 1px solid var(--grey-200);
            color: var(--grey-900);
        }

        .modal-table td:first-child {
            text-align: left;
            font-weight: 500;
        }

        .modal-table tr:last-child td {
            border-bottom: none;
        }

        .modal-table tr:hover {
            background: rgba(103, 58, 183, 0.05);
        }

        /* Ï†ïÎ†¨ Í∞ÄÎä•Ìïú Ìó§Îçî */
        .modal-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: background 0.2s ease;
        }

        .modal-table th.sortable:hover {
            background: var(--grey-200);
        }

        .modal-table th.sortable .sort-icon {
            display: inline-block;
            margin-left: 4px;
            font-size: 10px;
            color: var(--grey-400);
            transition: color 0.2s ease;
        }

        .modal-table th.sortable.active .sort-icon {
            color: var(--primary-main);
        }

        /* Î™®Îã¨ ÎçîÎ≥¥Í∏∞/Ï†ëÍ∏∞ Î≤ÑÌäº */
        .modal-show-more-container {
            padding: 12px 16px;
            text-align: center;
            border-top: 1px solid var(--grey-200);
        }

        .modal-show-more-btn {
            padding: 8px 24px;
            background: var(--grey-100);
            color: var(--grey-700);
            border: 1px solid var(--grey-300);
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .modal-show-more-btn:hover {
            background: var(--primary-light);
            color: var(--primary-main);
            border-color: var(--primary-main);
        }

        /* Î™®Îã¨ KPI 2Ìñâ Î†àÏù¥ÏïÑÏõÉ */
        .modal-kpi-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        .modal-kpi-row:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .modal-kpi-row {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* KPI ÌïÑÌÑ∞ ÌÜ†Í∏Ä Î≤ÑÌäº */
        .kpi-filter-toggle {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            background: var(--grey-100);
            color: var(--grey-500);
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .kpi-filter-toggle:hover {
            border-color: var(--primary-main);
        }

        .kpi-filter-toggle.active {
            background: var(--primary-main);
            color: white;
            border-color: var(--primary-main);
        }

        .kpi-filter-toggle .toggle-status {
            display: inline-block;
        }

        /* KPI ÌîÑÎ¶¨ÏÖã ÏÑ†ÌÉù */
        .kpi-preset-section {
            display: flex;
            align-items: flex-end;
            gap: 16px;
            flex-wrap: wrap;
        }

        .kpi-preset-select {
            padding: 10px 14px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: var(--paper);
            color: var(--grey-900);
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 280px;
        }

        .kpi-preset-select:hover {
            border-color: var(--primary-main);
        }

        .kpi-preset-select:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .kpi-preset-select optgroup {
            font-weight: 600;
            color: var(--grey-700);
        }

        .kpi-preset-select option {
            padding: 8px;
            font-weight: 400;
        }

        .kpi-preset-description {
            font-size: 12px;
            color: var(--primary-main);
            background: var(--primary-light);
            padding: 8px 12px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .kpi-preset-description::before {
            content: '‚úì';
            font-weight: bold;
        }

        /* Ï°∞Ìï© Ï°∞Í±¥ ÎùºÎîîÏò§ Î≤ÑÌäº */
        .compound-radio-group {
            display: flex;
            gap: 8px;
            align-items: center;
            height: 38px;
        }

        .compound-radio-group .radio-label {
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            font-size: 13px;
            color: var(--grey-700);
        }

        .compound-radio-group .radio-label input[type="radio"] {
            margin: 0;
            cursor: pointer;
        }

        .compound-radio-group .radio-label span {
            white-space: nowrap;
        }

        /* Î≥¥Ï°∞ ÌïÑÌÑ∞ Ìñâ */
        .secondary-filter-row {
            padding-top: 12px;
            border-top: 1px dashed var(--grey-300);
        }

        .secondary-filter-row::before {
            content: 'Ï°∞Í±¥ 2';
            display: block;
            font-size: 12px;
            color: var(--primary-main);
            font-weight: 600;
            margin-bottom: 8px;
            width: 100%;
        }

        /* 3Ï∞® ÌïÑÌÑ∞ Ìñâ */
        .tertiary-filter-row {
            padding-top: 12px;
            border-top: 1px dashed var(--grey-300);
        }

        .tertiary-filter-row::before {
            content: 'Ï°∞Í±¥ 3';
            display: block;
            font-size: 12px;
            color: var(--primary-main);
            font-weight: 600;
            margin-bottom: 8px;
            width: 100%;
        }

        /* Ï†ïÎ†¨ ÎùºÎîîÏò§ Î≤ÑÌäº */
        .sort-radio-group {
            display: flex;
            gap: 12px;
            align-items: center;
            height: 38px;
        }

        .sort-radio-group .radio-label {
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            font-size: 13px;
            color: var(--grey-700);
        }

        .sort-radio-group .radio-label input[type="radio"] {
            margin: 0;
            cursor: pointer;
        }

        .sort-radio-group .radio-label span {
            white-space: nowrap;
        }

        /* KPI ÌïÑÌÑ∞ + Ï†ïÎ†¨ ÌÜµÌï© Î†àÏù¥ÏïÑÏõÉ */
        .unified-filter-container {
            display: flex;
            gap: 32px;
            align-items: flex-start;
        }

        .unified-filter-left {
            flex: 0 1 auto;
        }

        .unified-filter-right {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
        }

        .unified-filter-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .unified-filter-title::before {
            content: '';
            width: 4px;
            height: 18px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        .unified-filter-content {
            display: flex;
            align-items: flex-end;
            gap: 16px;
            flex-wrap: wrap;
        }

        @media (max-width: 1200px) {
            .unified-filter-container {
                flex-direction: column;
                gap: 20px;
            }

            .unified-filter-left {
                padding-right: 0;
            }

            .unified-filter-right {
                padding-left: 0;
            }
        }

        /* Ï†ëÍ∏∞/ÌéºÏπòÍ∏∞ ÏÑπÏÖò */
        .collapsible-section {
            margin-bottom: 24px;
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            padding: 16px 20px;
            background: var(--paper);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: box-shadow 0.2s ease;
        }

        .collapsible-header:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .collapsible-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
        }

        .collapsible-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        .collapsible-guide {
            font-size: 12px;
            font-weight: 400;
            color: var(--grey-500);
            margin-left: 8px;
        }

        .collapsible-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--primary-light);
            color: var(--primary-main);
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.15s ease, color 0.15s ease;
        }

        .collapsible-toggle:hover {
            background: var(--primary-main);
            color: white;
        }

        .collapsible-toggle-icon {
            transition: transform 0.2s ease;
            transform: rotate(180deg);
        }

        .collapsible-toggle-icon.collapsed {
            transform: rotate(0deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.3s ease, opacity 0.2s ease, padding 0.3s ease;
        }

        .collapsible-content.expanded {
            max-height: 2000px;
            opacity: 1;
            padding-top: 16px;
        }

        /* ÌÜµÌï© ÌïÑÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà */
        .filter-inline-container {
            display: flex;
            align-items: flex-start;
            gap: 48px;
            flex-wrap: wrap;
        }

        /* Í∏∞Í∞Ñ ÏÑ†ÌÉù ÏòÅÏó≠ */
        .filter-date-section {
            display: flex;
            flex-direction: column;
            gap: 37px;
        }

        .filter-date-section .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--grey-900);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .filter-date-section .filter-label::before {
            content: '';
            width: 4px;
            height: 18px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        /* ÌïÑÌÑ∞ ÏÑ§Ï†ï ÏòÅÏó≠ */
        .filter-setting-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex: 1;
        }

        .filter-setting-section .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--grey-900);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .filter-setting-section .filter-label::before {
            content: '';
            width: 4px;
            height: 18px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        .filter-setting-section .filter-items {
            display: flex;
            align-items: flex-end;
            gap: 16px;
            flex: 1;
        }

        .filter-setting-section .filter-group {
            flex: 1;
            min-width: 0;
        }

        @media (max-width: 768px) {
            .filter-inline-container {
                flex-direction: column;
                gap: 24px;
            }

            .filter-date-section {
                width: 100%;
            }

            .filter-setting-section {
                width: 100%;
            }

            .filter-setting-section .filter-items {
                flex-direction: column;
            }

            .filter-setting-section .filter-group {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo">
                    <div class="sidebar-logo-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                        </svg>
                    </div>
                    <div>
                        <div class="sidebar-logo-text">Analytics</div>
                        <div class="sidebar-logo-subtitle">Dashboard</div>
                    </div>
                </a>
            </div>

            <div class="simplebar-content-wrapper">
                <div class="sidebar-content">
                    <!-- ÎåÄÏãúÎ≥¥Îìú Í∑∏Î£π -->
                    <div class="nav-group">
                        <div class="nav-group-title">ÎåÄÏãúÎ≥¥Îìú</div>
                        <a href="marketing_dashboard_v3.html" class="nav-item">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">Í¥ëÍ≥† ÏÑ±Í≥º ÎåÄÏãúÎ≥¥Îìú</span>
                        </a>
                        <a href="creative_analysis.html" class="nav-item active">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">ÏÜåÏû¨Î≥Ñ ÎåÄÏãúÎ≥¥Îìú</span>
                        </a>
                    </div>

                    <!-- Î∂ÑÏÑù Í∑∏Î£π -->
                    <div class="nav-group">
                        <div class="nav-group-title">Î∂ÑÏÑù</div>
                        <a href="timeseries_analysis.html" class="nav-item">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">ÏãúÍ≥ÑÏó¥ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù</span>
                        </a>
                        <a href="#" class="nav-item">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M11 2v20c-5.07-.5-9-4.79-9-10s3.93-9.5 9-10zm2.03 0v8.99H22c-.47-4.74-4.24-8.52-8.97-8.99zm0 11.01V22c4.74-.47 8.5-4.25 8.97-8.99h-8.97z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">Ï±ÑÎÑêÎ≥Ñ ÎπÑÍµê</span>
                        </a>
                        <a href="funnel_dashboard.html" class="nav-item">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.73-4.8 5.75-7.39C20.26 4.95 19.79 4 18.95 4H5.04c-.83 0-1.31.95-.79 1.61z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">ÌçºÎÑê ÎåÄÏãúÎ≥¥Îìú</span>
                        </a>
                    </div>

                    <!-- ÏßÄÏõê Í∑∏Î£π -->
                    <div class="nav-group">
                        <div class="nav-group-title">ÏßÄÏõê</div>
                        <a href="Qna.html" class="nav-item">
                            <div class="nav-item-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                                </svg>
                            </div>
                            <span class="nav-item-text">FAQ & Î¨∏ÏùòÌïòÍ∏∞</span>
                        </a>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
        <main class="main-content">
            <div class="container">
                <!-- Ìó§Îçî -->
                <div class="header">
                    <div>
                        <h1>Í¥ëÍ≥† ÏÜåÏû¨Î≥Ñ Î∂ÑÏÑù</h1>
                        <div class="header-subtitle">Í¥ëÍ≥† ÏÜåÏû¨(Ïù¥ÎØ∏ÏßÄ/ÏòÅÏÉÅ)Î≥Ñ ÏÑ±Í≥º Î∂ÑÏÑù</div>
                    </div>
                </div>

                <!-- ÌïÑÌÑ∞ ÏÑ§Ï†ï (Ï†ëÍ∏∞/ÌéºÏπòÍ∏∞) -->
                <div class="collapsible-section">
                    <div class="collapsible-header" id="filterCollapsibleHeader">
                        <div class="collapsible-title">ÌïÑÌÑ∞ ÏÑ§Ï†ï <span class="collapsible-guide">* ÌéºÏ≥êÏÑú ÏÑ∏Î∂Ä ÏÑ±Í≥ºÎ•º ÌïÑÌÑ∞ÎßÅÌï† Ïàò ÏûàÏñ¥Ïöî</span></div>
                        <button class="collapsible-toggle">
                            <span>ÌéºÏπòÍ∏∞</span>
                            <span class="collapsible-toggle-icon collapsed">‚ñº</span>
                        </button>
                    </div>
                    <div class="collapsible-content" id="filterCollapsibleContent">
                        <!-- Í∏∞Í∞Ñ ÏÑ†ÌÉù + Í∏∞Î≥∏ ÌïÑÌÑ∞ -->
                        <div class="filter-section card" style="margin-bottom: 16px;">
                            <div class="filter-section-header">
                                <div class="filter-header">Í∏∞Í∞Ñ Î∞è Í∏∞Î≥∏ ÌïÑÌÑ∞</div>
                                <button class="reset-btn" onclick="resetBasicFilters()">Ï¥àÍ∏∞Ìôî</button>
                            </div>
                            <div class="filter-inline-container">
                                <!-- Í∏∞Í∞Ñ ÏÑ†ÌÉù -->
                                <div class="filter-date-section">
                                    <div class="filter-label">Í∏∞Í∞Ñ ÏÑ†ÌÉù</div>
                                    <div class="date-range">
                                        <input type="date" id="startDate">
                                        <span>~</span>
                                        <input type="date" id="endDate">
                                    </div>
                                </div>
                                <!-- Í∏∞Î≥∏ ÌïÑÌÑ∞ -->
                                <div class="filter-setting-section">
                                    <div class="filter-label">Í∏∞Î≥∏ ÌïÑÌÑ∞</div>
                                    <div class="filter-items">
                                        <div class="filter-group">
                                            <label>Ïú†ÌòïÍµ¨Î∂Ñ</label>
                                            <select id="filterType">
                                                <option value="">Ï†ÑÏ≤¥</option>
                                            </select>
                                        </div>
                                        <div class="filter-group">
                                            <label>Î∏åÎûúÎìúÎ™Ö</label>
                                            <select id="filterBrand">
                                                <option value="">Ï†ÑÏ≤¥</option>
                                            </select>
                                        </div>
                                        <div class="filter-group">
                                            <label>ÏÉÅÌíàÎ™Ö</label>
                                            <select id="filterProduct">
                                                <option value="">Ï†ÑÏ≤¥</option>
                                            </select>
                                        </div>
                                        <div class="filter-group">
                                            <label>ÌîÑÎ°úÎ™®ÏÖò</label>
                                            <select id="filterPromotion">
                                                <option value="">Ï†ÑÏ≤¥</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ÏÑ∏Î∂Ä ÌïÑÌÑ∞ -->
                        <div class="filter-section card">
                            <div class="filter-section-header">
                                <div class="filter-header">ÏÑ∏Î∂Ä ÌïÑÌÑ∞</div>
                                <button class="reset-btn" onclick="resetDetailFilters()">Ï¥àÍ∏∞Ìôî</button>
                            </div>
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label>Ï∫†ÌéòÏù∏</label>
                                    <select id="filterCampaign">
                                        <option value="">Ï†ÑÏ≤¥</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Í¥ëÍ≥†ÏÑ∏Ìä∏</label>
                                    <select id="filterAdSet">
                                        <option value="">Ï†ÑÏ≤¥</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label>ÏÜåÏû¨ Í≤ÄÏÉâ</label>
                                    <input type="text" id="searchText" placeholder="ÏÜåÏû¨Ïù¥Î¶Ñ Í≤ÄÏÉâ..." style="flex: 1;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KPI Í∏∞Ï§Ä ÌïÑÌÑ∞ + Ï†ïÎ†¨ ÏÑ§Ï†ï ÌÜµÌï© -->
                <div class="filter-section card">
                    <div class="unified-filter-container">
                        <!-- ÏôºÏ™Ω: KPI Í∏∞Ï§Ä ÌïÑÌÑ∞ -->
                        <div class="unified-filter-left">
                            <div class="unified-filter-title">
                                KPI Í∏∞Ï§Ä ÌïÑÌÑ∞
                                <button type="button" id="kpiFilterToggle" class="kpi-filter-toggle" style="margin-left: 12px; width: auto; padding: 4px 10px; font-size: 11px;">
                                    <span class="toggle-status">OFF</span>
                                </button>
                            </div>
                            <!-- ÌîÑÎ¶¨ÏÖã ÏÑ†ÌÉù ÏòÅÏó≠ -->
                            <div class="kpi-preset-section" style="margin-bottom: 12px;">
                                <div class="filter-group" style="flex: 0 0 auto; min-width: 200px;">
                                    <label>Îπ†Î•∏ ÌïÑÌÑ∞</label>
                                    <select id="kpiPresetSelect" class="kpi-preset-select">
                                        <option value="">ÏßÅÏ†ë ÏûÖÎ†•</option>
                                        <optgroup label="Ìö®Ïú® Í∏∞Ï§Ä">
                                            <option value="high_roas">üèÜ Í≥†Ìö®Ïú® ÏÜåÏû¨ (ROAS > 500%)</option>
                                            <option value="low_cpa">üéØ Ï†ÄCPA ÏÜåÏû¨ (CPA < 1ÎßåÏõê)</option>
                                            <option value="low_efficiency">‚ö†Ô∏è Ï†ÄÌö®Ïú® ÏÜåÏû¨ (ROAS < 100%)</option>
                                        </optgroup>
                                        <optgroup label="ÏÑ±Í≥º Í∏∞Ï§Ä">
                                            <option value="high_revenue">üí∞ Í≥†Îß§Ï∂ú ÏÜåÏû¨ (Ï†ÑÌôòÍ∞í > 100ÎßåÏõê)</option>
                                            <option value="high_conversion">üìà Í≥†Ï†ÑÌôò ÏÜåÏû¨ (Ï†ÑÌôòÏàò > 10Í±¥)</option>
                                            <option value="high_spend">üî• Í≥†ÏßÄÏ∂ú ÏÜåÏû¨ (ÎπÑÏö© > 50ÎßåÏõê)</option>
                                        </optgroup>
                                        <optgroup label="Î≥µÌï© Ï°∞Í±¥">
                                            <option value="hidden_gem">üíé Ïà®ÏùÄ Î≥¥ÏÑù (ROAS > 300% AND ÎπÑÏö© < 10Îßå)</option>
                                            <option value="scale_up">üöÄ Ïä§ÏºÄÏùºÏóÖ ÌõÑÎ≥¥ (ROAS > 200% AND Ï†ÑÌôò > 5)</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <div id="kpiPresetDescription" class="kpi-preset-description" style="display: none;"></div>
                            </div>
                            <!-- ÏßÅÏ†ë ÏûÖÎ†• ÏòÅÏó≠ -->
                            <div id="kpiManualInputSection" class="unified-filter-content" style="margin-bottom: 0;">
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>KPI Í∏∞Ï§Ä</label>
                                    <select id="kpiFilterMetric">
                                        <option value="ÎπÑÏö©">ÎπÑÏö©</option>
                                        <option value="ÎÖ∏Ï∂ú">ÎÖ∏Ï∂ú</option>
                                        <option value="ÌÅ¥Î¶≠">ÌÅ¥Î¶≠</option>
                                        <option value="Ï†ÑÌôòÏàò">Ï†ÑÌôòÏàò</option>
                                        <option value="Ï†ÑÌôòÍ∞í">Ï†ÑÌôòÍ∞í</option>
                                        <option value="CPC">CPC</option>
                                        <option value="CPA">CPA</option>
                                        <option value="ROAS">ROAS</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Ï°∞Í±¥</label>
                                    <select id="kpiFilterOperator">
                                        <option value=">">> (Î≥¥Îã§ ÌÅº)</option>
                                        <option value="<">< (Î≥¥Îã§ ÏûëÏùå)</option>
                                        <option value=">=">>= (ÌÅ¨Í±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="<="><= (ÏûëÍ±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="=">= (Í∞ôÏùå)</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Í∏∞Ï§ÄÍ∞í</label>
                                    <input type="text" id="kpiFilterValue" placeholder="ÏàòÏπò ÏûÖÎ†•" class="formatted-number">
                                </div>
                                <div class="filter-group" style="flex: 0 0 140px;">
                                    <label>Ï°∞Ìï© Ï°∞Í±¥</label>
                                    <div class="compound-radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogic" value="none" checked>
                                            <span>ÏóÜÏùå</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogic" value="or">
                                            <span>ÎòêÎäî</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogic" value="and">
                                            <span>Í∑∏Î¶¨Í≥†</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- Î≥¥Ï°∞ ÌïÑÌÑ∞ Í∑∏Î£π (OR/AND ÏÑ†ÌÉùÏãú ÌëúÏãú) -->
                            <div class="filter-row secondary-filter-row" id="secondaryFilterRow" style="align-items: flex-end; margin-top: 12px; display: none;">
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>KPI Í∏∞Ï§Ä</label>
                                    <select id="kpiFilterMetricSecondary">
                                        <option value="ÎπÑÏö©">ÎπÑÏö©</option>
                                        <option value="ÎÖ∏Ï∂ú">ÎÖ∏Ï∂ú</option>
                                        <option value="ÌÅ¥Î¶≠">ÌÅ¥Î¶≠</option>
                                        <option value="Ï†ÑÌôòÏàò">Ï†ÑÌôòÏàò</option>
                                        <option value="Ï†ÑÌôòÍ∞í">Ï†ÑÌôòÍ∞í</option>
                                        <option value="CPC">CPC</option>
                                        <option value="CPA">CPA</option>
                                        <option value="ROAS">ROAS</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Ï°∞Í±¥</label>
                                    <select id="kpiFilterOperatorSecondary">
                                        <option value=">">> (Î≥¥Îã§ ÌÅº)</option>
                                        <option value="<">< (Î≥¥Îã§ ÏûëÏùå)</option>
                                        <option value=">=">>= (ÌÅ¨Í±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="<="><= (ÏûëÍ±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="=">= (Í∞ôÏùå)</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Í∏∞Ï§ÄÍ∞í</label>
                                    <input type="text" id="kpiFilterValueSecondary" placeholder="ÏàòÏπò ÏûÖÎ†•" class="formatted-number">
                                </div>
                                <div class="filter-group" style="flex: 0 0 140px;">
                                    <label>Ï°∞Ìï© Ï°∞Í±¥</label>
                                    <div class="compound-radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogicSecondary" value="none" checked>
                                            <span>ÏóÜÏùå</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogicSecondary" value="or">
                                            <span>ÎòêÎäî</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="compoundLogicSecondary" value="and">
                                            <span>Í∑∏Î¶¨Í≥†</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- 3Ï∞® ÌïÑÌÑ∞ Í∑∏Î£π (OR/AND ÏÑ†ÌÉùÏãú ÌëúÏãú) -->
                            <div class="filter-row tertiary-filter-row" id="tertiaryFilterRow" style="align-items: flex-end; margin-top: 12px; display: none;">
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>KPI Í∏∞Ï§Ä</label>
                                    <select id="kpiFilterMetricTertiary">
                                        <option value="ÎπÑÏö©">ÎπÑÏö©</option>
                                        <option value="ÎÖ∏Ï∂ú">ÎÖ∏Ï∂ú</option>
                                        <option value="ÌÅ¥Î¶≠">ÌÅ¥Î¶≠</option>
                                        <option value="Ï†ÑÌôòÏàò">Ï†ÑÌôòÏàò</option>
                                        <option value="Ï†ÑÌôòÍ∞í">Ï†ÑÌôòÍ∞í</option>
                                        <option value="CPC">CPC</option>
                                        <option value="CPA">CPA</option>
                                        <option value="ROAS">ROAS</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Ï°∞Í±¥</label>
                                    <select id="kpiFilterOperatorTertiary">
                                        <option value=">">> (Î≥¥Îã§ ÌÅº)</option>
                                        <option value="<">< (Î≥¥Îã§ ÏûëÏùå)</option>
                                        <option value=">=">>= (ÌÅ¨Í±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="<="><= (ÏûëÍ±∞ÎÇò Í∞ôÏùå)</option>
                                        <option value="=">= (Í∞ôÏùå)</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Í∏∞Ï§ÄÍ∞í</label>
                                    <input type="text" id="kpiFilterValueTertiary" placeholder="ÏàòÏπò ÏûÖÎ†•" class="formatted-number">
                                </div>
                            </div>
                        </div>

                        <!-- Ïò§Î•∏Ï™Ω: Ï†ïÎ†¨ ÏÑ§Ï†ï -->
                        <div class="unified-filter-right">
                            <div class="unified-filter-title">Ï†ïÎ†¨ ÏÑ§Ï†ï</div>
                            <div class="unified-filter-content">
                                <div class="filter-group" style="flex: 0 0 100px;">
                                    <label>Ï†ïÎ†¨ Í∏∞Ï§Ä</label>
                                    <select id="sortMetric">
                                        <option value="ÎπÑÏö©">ÎπÑÏö©</option>
                                        <option value="ÎÖ∏Ï∂ú">ÎÖ∏Ï∂ú</option>
                                        <option value="ÌÅ¥Î¶≠">ÌÅ¥Î¶≠</option>
                                        <option value="Ï†ÑÌôòÏàò">Ï†ÑÌôòÏàò</option>
                                        <option value="Ï†ÑÌôòÍ∞í">Ï†ÑÌôòÍ∞í</option>
                                        <option value="CPC">CPC</option>
                                        <option value="CPA">CPA</option>
                                        <option value="ROAS">ROAS</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="flex: 0 0 auto;">
                                    <label>Ï†ïÎ†¨ ÏàúÏÑú</label>
                                    <div class="sort-radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="sortOrder" value="desc" checked>
                                            <span>ÎÇ¥Î¶ºÏ∞®Ïàú</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="sortOrder" value="asc">
                                            <span>Ïò§Î¶ÑÏ∞®Ïàú</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÏöîÏïΩ ÏÑπÏÖò -->
                <div class="summary-section">
                    <div class="summary-grid">
                        <div class="summary-card card">
                            <h3>Ï¥ù ÎπÑÏö©</h3>
                            <div class="value" id="totalCost">-</div>
                            <div class="unit">Ïõê</div>
                        </div>
                        <div class="summary-card card">
                            <h3>ÌèâÍ∑† CPM</h3>
                            <div class="value" id="avgCPM">-</div>
                            <div class="unit">Ïõê</div>
                        </div>
                        <div class="summary-card card">
                            <h3>ÌèâÍ∑† CPC</h3>
                            <div class="value" id="avgCPC">-</div>
                            <div class="unit">Ïõê</div>
                        </div>
                        <div class="summary-card card">
                            <h3>ÌèâÍ∑† CPA</h3>
                            <div class="value" id="avgCPA">-</div>
                            <div class="unit">Ïõê</div>
                        </div>
                        <div class="summary-card card">
                            <h3>ÌèâÍ∑† ROAS</h3>
                            <div class="value" id="avgROAS">-</div>
                            <div class="unit"></div>
                        </div>
                    </div>
                </div>

                <!-- ÏÜåÏû¨ Í∑∏Î¶¨Îìú -->
                <div class="creative-grid" id="creativeGrid">
                    <div class="loading">Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
                </div>
            </div>
        </main>
    </div>

    <!-- ÏÑ∏Î∂Ä ÏÑ±Í≥º Î™®Îã¨ -->
    <div class="modal-overlay" id="creativeModal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">ÏÜåÏû¨ ÏÑ∏Î∂Ä ÏÑ±Í≥º</div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Î∑∞ ÌÉÄÏûÖ ÏÑ†ÌÉù -->
                <div class="modal-view-type-section">
                    <button class="modal-view-btn active" data-view="daily" onclick="changeModalViewType('daily')">ÏùºÎ≥Ñ</button>
                    <button class="modal-view-btn" data-view="weekly" onclick="changeModalViewType('weekly')">Ï£ºÎ≥Ñ</button>
                    <button class="modal-view-btn" data-view="monthly" onclick="changeModalViewType('monthly')">ÏõîÎ≥Ñ</button>
                </div>

                <!-- KPI Ïπ¥Îìú (2Ìñâ) -->
                <div id="modalKpiGrid">
                    <!-- ÏÉÅÎã® Ìñâ: ÎπÑÏö©, CPC, CPA, ROAS -->
                    <div class="modal-kpi-row" id="modalKpiRowTop">
                        <!-- JSÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
                    </div>
                    <!-- ÌïòÎã® Ìñâ: ÎÖ∏Ï∂ú, ÌÅ¥Î¶≠, Ï†ÑÌôòÏàò, Ï†ÑÌôòÍ∞í -->
                    <div class="modal-kpi-row" id="modalKpiRowBottom">
                        <!-- JSÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
                    </div>
                </div>

                <!-- ÏÑ±Í≥º Ï∂îÏù¥ Ï∞®Ìä∏ -->
                <div class="modal-chart-section">
                    <div class="modal-chart-title">ÏÑ±Í≥º Ï∂îÏù¥</div>
                    <div class="modal-chart-controls">
                        <div class="modal-chart-toggle-group" style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button type="button" class="data-label-toggle active" data-chart-toggle="modalChartCost">
                                <span class="toggle-checkbox">‚úì</span>
                                <span>ÎπÑÏö©</span>
                            </button>
                            <button type="button" class="data-label-toggle" data-chart-toggle="modalChartCPM">
                                <span class="toggle-checkbox">‚òê</span>
                                <span>CPM</span>
                            </button>
                            <button type="button" class="data-label-toggle" data-chart-toggle="modalChartCPC">
                                <span class="toggle-checkbox">‚òê</span>
                                <span>CPC</span>
                            </button>
                            <button type="button" class="data-label-toggle" data-chart-toggle="modalChartCPA">
                                <span class="toggle-checkbox">‚òê</span>
                                <span>CPA</span>
                            </button>
                            <button type="button" class="data-label-toggle active" data-chart-toggle="modalChartROAS">
                                <span class="toggle-checkbox">‚úì</span>
                                <span>ROAS</span>
                            </button>
                        </div>
                        <!-- Ïà®Í≤®ÏßÑ Ï≤¥ÌÅ¨Î∞ïÏä§ (Í∏∞Ï°¥ Í∏∞Îä• Ïú†ÏßÄÏö©) -->
                        <div style="display: none;">
                            <input type="checkbox" id="modalChartCost" checked>
                            <input type="checkbox" id="modalChartCPM">
                            <input type="checkbox" id="modalChartCPC">
                            <input type="checkbox" id="modalChartCPA">
                            <input type="checkbox" id="modalChartROAS" checked>
                        </div>
                        <button class="modal-data-label-toggle" id="modalDataLabelToggle">
                            <span class="toggle-checkbox">‚òê</span>
                            <span>Îç∞Ïù¥ÌÑ∞ ÎùºÎ≤®</span>
                        </button>
                    </div>
                    <div class="modal-chart">
                        <canvas id="modalChart"></canvas>
                    </div>
                </div>

                <!-- ÏÉÅÏÑ∏ Îç∞Ïù¥ÌÑ∞ ÌÖåÏù¥Î∏î -->
                <div class="modal-table-section">
                    <div class="modal-table-title">ÏÉÅÏÑ∏ Îç∞Ïù¥ÌÑ∞</div>
                    <div class="modal-table-container">
                        <table class="modal-table">
                            <thead>
                                <tr>
                                    <th class="sortable active" onclick="toggleModalTableSort()">Í∏∞Í∞Ñ <span class="sort-icon" id="modalSortIcon">‚ñº</span></th>
                                    <th>ÎπÑÏö©</th>
                                    <th>ÎÖ∏Ï∂ú</th>
                                    <th>CPM</th>
                                    <th>ÌÅ¥Î¶≠</th>
                                    <th>CTR</th>
                                    <th>CPC</th>
                                    <th>Ï†ÑÌôòÏàò</th>
                                    <th>CPA</th>
                                    <th>Ï†ÑÌôòÍ∞í</th>
                                    <th>ROAS</th>
                                </tr>
                            </thead>
                            <tbody id="modalTableBody">
                                <!-- JSÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-show-more-container" id="modalShowMoreContainer" style="display: none;">
                        <button class="modal-show-more-btn" onclick="expandModalTable()">Îçî Î≥¥Í∏∞ (<span id="modalHiddenCount">0</span>Í∞ú)</button>
                    </div>
                    <div class="modal-show-more-container" id="modalCollapseContainer" style="display: none;">
                        <button class="modal-show-more-btn" onclick="collapseModalTable()">Ï†ëÍ∏∞</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Datalabels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

    <script>
        // Chart.js Datalabels ÌîåÎü¨Í∑∏Ïù∏ Îì±Î°ù
        Chart.register(ChartDataLabels);
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let allData = [];
        let imageUrlMap = {}; // ÏÜåÏû¨Ïù¥Î¶Ñ -> Ïù¥ÎØ∏ÏßÄ URL Îß§Ìïë (1ÏàúÏúÑ)
        let fallbackUrlMap = {}; // ÏÜåÏû¨Ïù¥Î¶Ñ -> ÎåÄÏ≤¥ Ïù¥ÎØ∏ÏßÄ URL Îß§Ìïë (2ÏàúÏúÑ)
        let originalUrlMap = {}; // ÏÜåÏû¨Ïù¥Î¶Ñ -> ÏõêÎ≥∏ URL Îß§Ìïë
        let filters = {
            type: '',
            brand: '',
            product: '',
            promotion: '',
            campaign: '',
            adSet: '',
            startDate: '',
            endDate: '',
            searchText: ''
        };

        // KPI Í∏∞Ï§Ä ÌïÑÌÑ∞
        let kpiFilter = {
            metric: 'ÎπÑÏö©',
            operator: '>',
            value: '',
            enabled: false,
            compoundLogic: 'none',
            secondaryMetric: 'ÎπÑÏö©',
            secondaryOperator: '>',
            secondaryValue: '',
            secondaryCompoundLogic: 'none',
            tertiaryMetric: 'ÎπÑÏö©',
            tertiaryOperator: '>',
            tertiaryValue: ''
        };

        // KPI ÌïÑÌÑ∞ ÌîÑÎ¶¨ÏÖã
        const KPI_PRESETS = {
            'high_roas': {
                name: 'üèÜ Í≥†Ìö®Ïú® ÏÜåÏû¨',
                description: 'ROAS > 500%',
                conditions: [
                    { metric: 'ROAS', operator: '>', value: 500 }
                ]
            },
            'high_revenue': {
                name: 'üí∞ Í≥†Îß§Ï∂ú ÏÜåÏû¨',
                description: 'Ï†ÑÌôòÍ∞í > 100ÎßåÏõê',
                conditions: [
                    { metric: 'Ï†ÑÌôòÍ∞í', operator: '>', value: 1000000 }
                ]
            },
            'low_cpa': {
                name: 'üéØ Ï†ÄCPA ÏÜåÏû¨',
                description: 'CPA < 1ÎßåÏõê',
                conditions: [
                    { metric: 'CPA', operator: '<', value: 10000 }
                ]
            },
            'high_conversion': {
                name: 'üìà Í≥†Ï†ÑÌôò ÏÜåÏû¨',
                description: 'Ï†ÑÌôòÏàò > 10Í±¥',
                conditions: [
                    { metric: 'Ï†ÑÌôòÏàò', operator: '>', value: 10 }
                ]
            },
            'high_spend': {
                name: 'üî• Í≥†ÏßÄÏ∂ú ÏÜåÏû¨',
                description: 'ÎπÑÏö© > 50ÎßåÏõê',
                conditions: [
                    { metric: 'ÎπÑÏö©', operator: '>', value: 500000 }
                ]
            },
            'low_efficiency': {
                name: '‚ö†Ô∏è Ï†ÄÌö®Ïú® ÏÜåÏû¨',
                description: 'ROAS < 100%',
                conditions: [
                    { metric: 'ROAS', operator: '<', value: 100 }
                ]
            },
            'hidden_gem': {
                name: 'üíé Ïà®ÏùÄ Î≥¥ÏÑù',
                description: 'ROAS > 300% AND ÎπÑÏö© < 10ÎßåÏõê',
                conditions: [
                    { metric: 'ROAS', operator: '>', value: 300 },
                    { compoundLogic: 'and' },
                    { metric: 'ÎπÑÏö©', operator: '<', value: 100000 }
                ]
            },
            'scale_up': {
                name: 'üöÄ Ïä§ÏºÄÏùºÏóÖ ÌõÑÎ≥¥',
                description: 'ROAS > 200% AND Ï†ÑÌôòÏàò > 5Í±¥',
                conditions: [
                    { metric: 'ROAS', operator: '>', value: 200 },
                    { compoundLogic: 'and' },
                    { metric: 'Ï†ÑÌôòÏàò', operator: '>', value: 5 }
                ]
            }
        };

        // Ï†ïÎ†¨ ÏÑ§Ï†ï
        let sortConfig = {
            metric: 'ÎπÑÏö©',
            order: 'desc'
        };

        // Ïà´Ïûê Ìè¨Îß∑ÌåÖ Ìï®Ïàò (#,###)
        function formatNumberInput(value) {
            // Ïà´ÏûêÏôÄ ÏÜåÏàòÏ†êÎßå ÎÇ®Í∏∞Í∏∞
            const num = value.replace(/[^\d.]/g, '');
            if (num === '') return '';

            // ÏÜåÏàòÏ†ê Ï≤òÎ¶¨
            const parts = num.split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            return parts.join('.');
        }

        // Ìè¨Îß∑Îêú Ïà´ÏûêÏóêÏÑú Ïã§Ï†ú Í∞í Ï∂îÏ∂ú
        function parseFormattedNumber(value) {
            return value.replace(/,/g, '');
        }

        // KPI ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetKpiFilter() {
            kpiFilter.metric = 'ÎπÑÏö©';
            kpiFilter.operator = '>';
            kpiFilter.value = '';
            kpiFilter.compoundLogic = 'none';
            kpiFilter.secondaryMetric = 'ÎπÑÏö©';
            kpiFilter.secondaryOperator = '>';
            kpiFilter.secondaryValue = '';
            kpiFilter.secondaryCompoundLogic = 'none';
            kpiFilter.tertiaryMetric = 'ÎπÑÏö©';
            kpiFilter.tertiaryOperator = '>';
            kpiFilter.tertiaryValue = '';

            // UI Ï¥àÍ∏∞Ìôî
            document.getElementById('kpiFilterMetric').value = 'ÎπÑÏö©';
            document.getElementById('kpiFilterOperator').value = '>';
            document.getElementById('kpiFilterValue').value = '';
            document.getElementById('kpiFilterMetricSecondary').value = 'ÎπÑÏö©';
            document.getElementById('kpiFilterOperatorSecondary').value = '>';
            document.getElementById('kpiFilterValueSecondary').value = '';
            document.getElementById('kpiFilterMetricTertiary').value = 'ÎπÑÏö©';
            document.getElementById('kpiFilterOperatorTertiary').value = '>';
            document.getElementById('kpiFilterValueTertiary').value = '';

            // ÎùºÎîîÏò§ Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
            document.querySelector('input[name="compoundLogic"][value="none"]').checked = true;
            document.querySelector('input[name="compoundLogicSecondary"][value="none"]').checked = true;

            // Î≥¥Ï°∞ ÌïÑÌÑ∞ Ìñâ Ïà®Í∏∞Í∏∞
            document.getElementById('secondaryFilterRow').style.display = 'none';
            document.getElementById('tertiaryFilterRow').style.display = 'none';
        }

        // KPI ÌîÑÎ¶¨ÏÖã Ï†ÅÏö©
        function applyKpiPreset(presetKey) {
            const preset = KPI_PRESETS[presetKey];
            const descriptionEl = document.getElementById('kpiPresetDescription');
            const manualInputSection = document.getElementById('kpiManualInputSection');

            if (!preset) {
                // ÏßÅÏ†ë ÏûÖÎ†• Î™®Îìú
                descriptionEl.style.display = 'none';
                manualInputSection.style.display = 'flex';
                resetKpiFilter();
                kpiFilter.enabled = false;
                updateKpiToggleUI(false);
                updateDashboard();
                return;
            }

            // ÌîÑÎ¶¨ÏÖã Ï†ÅÏö©
            resetKpiFilter();

            const conditions = preset.conditions;
            let conditionIndex = 0;

            for (let i = 0; i < conditions.length; i++) {
                const cond = conditions[i];

                if (cond.compoundLogic) {
                    // Ï°∞Ìï© Ï°∞Í±¥ ÏÑ§Ï†ï
                    if (conditionIndex === 0) {
                        kpiFilter.compoundLogic = cond.compoundLogic;
                        document.querySelector(`input[name="compoundLogic"][value="${cond.compoundLogic}"]`).checked = true;
                        document.getElementById('secondaryFilterRow').style.display = 'flex';
                    } else if (conditionIndex === 1) {
                        kpiFilter.secondaryCompoundLogic = cond.compoundLogic;
                        document.querySelector(`input[name="compoundLogicSecondary"][value="${cond.compoundLogic}"]`).checked = true;
                        document.getElementById('tertiaryFilterRow').style.display = 'flex';
                    }
                } else {
                    // Ï°∞Í±¥ ÏÑ§Ï†ï
                    if (conditionIndex === 0) {
                        kpiFilter.metric = cond.metric;
                        kpiFilter.operator = cond.operator;
                        kpiFilter.value = String(cond.value);
                        document.getElementById('kpiFilterMetric').value = cond.metric;
                        document.getElementById('kpiFilterOperator').value = cond.operator;
                        document.getElementById('kpiFilterValue').value = formatNumberInput(String(cond.value));
                    } else if (conditionIndex === 1) {
                        kpiFilter.secondaryMetric = cond.metric;
                        kpiFilter.secondaryOperator = cond.operator;
                        kpiFilter.secondaryValue = String(cond.value);
                        document.getElementById('kpiFilterMetricSecondary').value = cond.metric;
                        document.getElementById('kpiFilterOperatorSecondary').value = cond.operator;
                        document.getElementById('kpiFilterValueSecondary').value = formatNumberInput(String(cond.value));
                    } else if (conditionIndex === 2) {
                        kpiFilter.tertiaryMetric = cond.metric;
                        kpiFilter.tertiaryOperator = cond.operator;
                        kpiFilter.tertiaryValue = String(cond.value);
                        document.getElementById('kpiFilterMetricTertiary').value = cond.metric;
                        document.getElementById('kpiFilterOperatorTertiary').value = cond.operator;
                        document.getElementById('kpiFilterValueTertiary').value = formatNumberInput(String(cond.value));
                    }
                    conditionIndex++;
                }
            }

            // ÌîÑÎ¶¨ÏÖã ÏÑ§Î™Ö ÌëúÏãú
            descriptionEl.textContent = preset.description;
            descriptionEl.style.display = 'flex';

            // ÏßÅÏ†ë ÏûÖÎ†• ÏòÅÏó≠ Ïà®Í∏∞Í∏∞ (ÌîÑÎ¶¨ÏÖã ÏÇ¨Ïö© Ïãú)
            manualInputSection.style.display = 'none';

            // ÌïÑÌÑ∞ ÏûêÎèô ÌôúÏÑ±Ìôî
            kpiFilter.enabled = true;
            updateKpiToggleUI(true);

            updateDashboard();
        }

        // KPI ÌÜ†Í∏Ä UI ÏóÖÎç∞Ïù¥Ìä∏ Ìó¨Ìçº
        function updateKpiToggleUI(enabled) {
            const toggle = document.getElementById('kpiFilterToggle');
            const status = toggle.querySelector('.toggle-status');
            if (enabled) {
                toggle.classList.add('active');
                status.textContent = 'ON';
            } else {
                toggle.classList.remove('active');
                status.textContent = 'OFF';
            }
        }

        // ÏÜåÏû¨ Îç∞Ïù¥ÌÑ∞ ÌååÏùº (data/creative Ìè¥Îçî)
        const creativeDataFile = './creative/Creative_data.csv';
        // Ïù¥ÎØ∏ÏßÄ URL Îß§Ìïë ÌååÏùº
        const imageUrlFile = './creative/Creative_url.csv';

        // CSV Ìïú Ï§Ñ ÌååÏã± (RFC 4180 Ìò∏Ìôò)
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];

                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        // Ïó∞ÏÜçÎêú Îî∞Ïò¥ÌëúÎäî Ïù¥Ïä§ÏºÄÏù¥ÌîÑÎêú Îî∞Ïò¥Ìëú
                        current += '"';
                        i++; // Îã§Ïùå Îî∞Ïò¥Ìëú Í±¥ÎÑàÎõ∞Í∏∞
                    } else {
                        // Îî∞Ïò¥Ìëú ÏãúÏûë/Ï¢ÖÎ£å
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    // Îî∞Ïò¥Ìëú Î∞ñÏùò ÏâºÌëúÎäî Íµ¨Î∂ÑÏûê
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }

            // ÎßàÏßÄÎßâ ÌïÑÎìú Ï∂îÍ∞Ä
            result.push(current);
            return result;
        }

        // CSV ÌååÏã± Ìï®Ïàò (RFC 4180 Ìò∏Ìôò)
        function parseCSV(text) {
            const lines = text.trim().split('\n');

            const headers = parseCSVLine(lines[0]).map(h => h.trim());

            return lines.slice(1).map(line => {
                const values = parseCSVLine(line);
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = values[index] ? values[index].trim() : '';
                });
                return obj;
            });
        }

        // CSV ÌååÏã± Ìï®Ïàò (Îî∞Ïò¥Ìëú Ï≤òÎ¶¨) - parseCSVÏôÄ ÎèôÏùºÌïòÍ≤å RFC 4180 Ìò∏Ìôò
        function parseCSVWithQuotes(text) {
            const lines = text.trim().split('\n');
            const headers = parseCSVLine(lines[0]);
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                if (values.length >= 2) {
                    const row = {};
                    headers.forEach((header, index) => {
                        row[header.trim().replace(/^"|"$/g, '')] = (values[index] || '').trim().replace(/^"|"$/g, '');
                    });
                    data.push(row);
                }
            }
            return data;
        }

        // Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadData() {
            try {
                // 1. Ïù¥ÎØ∏ÏßÄ URL Îß§Ìïë Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                const urlResponse = await fetch(imageUrlFile);
                if (urlResponse.ok) {
                    const urlText = await urlResponse.text();
                    const urlData = parseCSVWithQuotes(urlText);
                    // Google Drive URLÏùÑ thumbnail ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò
                    function convertGoogleDriveUrl(url) {
                        const driveMatch = url.match(/drive\.google\.com\/file\/d\/([^\/]+)\/view/);
                        if (driveMatch) {
                            return `https://drive.google.com/thumbnail?id=${driveMatch[1]}&sz=w1000`;
                        }
                        return url;
                    }

                    // ÏÜåÏû¨Ïù¥Î¶Ñ -> URL Îß§Ìïë ÏÉùÏÑ±
                    // Ïö∞ÏÑ†ÏàúÏúÑ: 1.drive.google.com > 2.facebook.com/ads/image,youtube > 3.scontent > 4.Í∏∞ÌÉÄ
                    urlData.forEach(row => {
                        const creativeName = row['Í¥ëÍ≥†,ÏóêÏÖãÏù¥Î¶Ñ'] || row['Í¥ëÍ≥†'];
                        const url = row['url'];
                        const originalUrl = row['ÏõêÎ≥∏ url / ID'] || row['ÏõêÎ≥∏url/ID'] || '';

                        if (creativeName && url) {
                            // originalUrlMapÏùÄ imageUrlMap Ïö∞ÏÑ†ÏàúÏúÑÏôÄ ÎèÖÎ¶ΩÏ†ÅÏúºÎ°ú Ï†ÄÏû•
                            // Ïú†Ìö®Ìïú ÏõêÎ≥∏ URLÏù¥ ÏûàÍ≥†, Í∏∞Ï°¥Ïóê Ï†ÄÏû•Îêú Í∞íÏù¥ ÏóÜÏúºÎ©¥ Ï†ÄÏû•
                            if (originalUrl && originalUrl !== '-' && !originalUrlMap[creativeName]) {
                                originalUrlMap[creativeName] = originalUrl;
                            }

                            // URL Ïú†Ìòï ÌåêÎ≥Ñ
                            const isGoogleDrive = url.includes('drive.google.com');
                            const isFacebookAdsImage = url.includes('facebook.com/ads/image');
                            const isYoutubeThumbnail = url.includes('img.youtube.com/vi/');
                            const isScontent = url.includes('scontent') || url.includes('googlesyndication');

                            // 1ÏàúÏúÑ: Google Drive URL (ÏµúÏö∞ÏÑ†, thumbnail ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò)
                            if (isGoogleDrive) {
                                const existingUrl = imageUrlMap[creativeName];
                                // Í∏∞Ï°¥Ïóê Google Drive URLÏù¥ ÏïÑÎãàÎ©¥ ÎçÆÏñ¥Ïì∞Í∏∞
                                if (!existingUrl || !existingUrl.includes('drive.google.com/thumbnail')) {
                                    // Í∏∞Ï°¥ URLÏù¥ ÏûàÏúºÎ©¥ fallbackÏúºÎ°ú Ïù¥Îèô
                                    if (existingUrl && !fallbackUrlMap[creativeName]) {
                                        fallbackUrlMap[creativeName] = existingUrl;
                                    }
                                    imageUrlMap[creativeName] = convertGoogleDriveUrl(url);
                                }
                            }
                            // 2ÏàúÏúÑ: facebook.com/ads/image ÎòêÎäî img.youtube.com
                            else if (isFacebookAdsImage || isYoutubeThumbnail) {
                                const existingUrl = imageUrlMap[creativeName];
                                // Google Drive URLÏù¥ Ïù¥ÎØ∏ ÏûàÏúºÎ©¥ Í±¥ÎÑàÎõ∞Í∏∞
                                const existingIsGoogleDrive = existingUrl && existingUrl.includes('drive.google.com/thumbnail');
                                if (!existingIsGoogleDrive) {
                                    const existingIsPrimary = existingUrl &&
                                        (existingUrl.includes('facebook.com/ads/image') || existingUrl.includes('img.youtube.com/vi/'));
                                    if (!existingIsPrimary) {
                                        // Í∏∞Ï°¥ URLÏù¥ scontentÎ©¥ fallbackÏúºÎ°ú Ïù¥Îèô
                                        if (existingUrl && (existingUrl.includes('scontent') || existingUrl.includes('googlesyndication'))) {
                                            fallbackUrlMap[creativeName] = existingUrl;
                                        }
                                        imageUrlMap[creativeName] = url;
                                    }
                                }
                            }
                            // 3ÏàúÏúÑ: scontent Îì± URL
                            else if (isScontent) {
                                const existingUrl = imageUrlMap[creativeName];
                                const existingIsGoogleDrive = existingUrl && existingUrl.includes('drive.google.com/thumbnail');
                                const existingIsPrimary = existingUrl &&
                                    (existingUrl.includes('facebook.com/ads/image') || existingUrl.includes('img.youtube.com/vi/'));

                                // 1,2ÏàúÏúÑ URLÏù¥ ÏûàÏúºÎ©¥ fallbackÏúºÎ°ú Ï†ÄÏû•
                                if (existingIsGoogleDrive || existingIsPrimary) {
                                    if (!fallbackUrlMap[creativeName]) {
                                        fallbackUrlMap[creativeName] = url;
                                    }
                                }
                                // 1,2ÏàúÏúÑ URLÏù¥ ÏóÜÏúºÎ©¥ primaryÎ°ú Ï†ÄÏû•
                                else if (!existingUrl) {
                                    imageUrlMap[creativeName] = url;
                                }
                            }
                            // 4ÏàúÏúÑ: Í∏∞ÌÉÄ URLÏùÄ ÏïÑÎ¨¥Í≤ÉÎèÑ ÏóÜÏùÑ ÎïåÎßå
                            else if (!imageUrlMap[creativeName]) {
                                imageUrlMap[creativeName] = url;
                            }
                        }
                    });
                    console.log('Ïù¥ÎØ∏ÏßÄ URL Îß§Ìïë ÏôÑÎ£å:', Object.keys(imageUrlMap).length, 'Í∞ú');
                    console.log('Fallback URL Îß§Ìïë ÏôÑÎ£å:', Object.keys(fallbackUrlMap).length, 'Í∞ú');
                    console.log('ÏõêÎ≥∏ URL Îß§Ìïë ÏôÑÎ£å:', Object.keys(originalUrlMap).length, 'Í∞ú');
                }

                // 2. ÏÜåÏû¨ ÏÑ±Í≥º Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                const dataResponse = await fetch(creativeDataFile);
                if (!dataResponse.ok) throw new Error('Failed to load creative data');
                const dataText = await dataResponse.text();
                allData = parseCSV(dataText);

                // ÌïÑÌÑ∞ ÏòµÏÖò ÏÑ§Ï†ï
                populateFilters();

                // ÎÇ†Ïßú Î≤îÏúÑ ÏÑ§Ï†ï
                setDateRange();

                // ÎåÄÏãúÎ≥¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
                updateDashboard();
            } catch (err) {
                console.error('Error loading data:', err);
                document.getElementById('creativeGrid').innerHTML =
                    '<div class="empty-state" style="grid-column: 1 / -1;"><h3>Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®</h3><p>Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§</p></div>';
            }
        }

        // ÌïÑÌÑ∞ ÏòµÏÖò ÏÑ§Ï†ï (Ïú†ÌòïÍµ¨Î∂ÑÎßå Ï¥àÍ∏∞Ìôî, ÎÇòÎ®∏ÏßÄÎäî Í≥ÑÏ∏µ Íµ¨Ï°∞)
        function populateFilters() {
            const types = [...new Set(allData.map(d => d['Ïú†ÌòïÍµ¨Î∂Ñ']))].filter(Boolean).sort();
            populateSelect('filterType', types);
            updateBrandFilter();
        }

        // Î∏åÎûúÎìúÎ™Ö ÌïÑÌÑ∞ (Ïú†ÌòïÍµ¨Î∂ÑÏùò ÌïòÏúÑ)
        function updateBrandFilter() {
            const filteredData = allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                return true;
            });
            const brands = [...new Set(filteredData.map(d => d['Î∏åÎûúÎìúÎ™Ö']))].filter(Boolean).sort();
            const brandSelect = document.getElementById('filterBrand');
            brandSelect.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            brands.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                brandSelect.appendChild(option);
            });
            if (!brands.includes(filters.brand)) {
                filters.brand = '';
                brandSelect.value = '';
            }
            updateProductFilter();
        }

        // ÏÉÅÌíàÎ™Ö ÌïÑÌÑ∞ (Î∏åÎûúÎìúÎ™ÖÏùò ÌïòÏúÑ)
        function updateProductFilter() {
            const filteredData = allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                if (filters.brand && row['Î∏åÎûúÎìúÎ™Ö'] !== filters.brand) return false;
                return true;
            });
            const products = [...new Set(filteredData.map(d => d['ÏÉÅÌíàÎ™Ö']))].filter(Boolean).sort();
            const productSelect = document.getElementById('filterProduct');
            productSelect.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            products.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                productSelect.appendChild(option);
            });
            if (!products.includes(filters.product)) {
                filters.product = '';
                productSelect.value = '';
            }
            updatePromotionFilter();
        }

        // ÌîÑÎ°úÎ™®ÏÖò ÌïÑÌÑ∞ (ÏÉÅÌíàÎ™ÖÏùò ÌïòÏúÑ)
        function updatePromotionFilter() {
            const filteredData = allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                if (filters.brand && row['Î∏åÎûúÎìúÎ™Ö'] !== filters.brand) return false;
                if (filters.product && row['ÏÉÅÌíàÎ™Ö'] !== filters.product) return false;
                return true;
            });
            const promotions = [...new Set(filteredData.map(d => d['ÌîÑÎ°úÎ™®ÏÖò']))].filter(Boolean).sort();
            const promotionSelect = document.getElementById('filterPromotion');
            promotionSelect.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            promotions.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                promotionSelect.appendChild(option);
            });
            if (!promotions.includes(filters.promotion)) {
                filters.promotion = '';
                promotionSelect.value = '';
            }
            updateCampaignFilter();
        }

        // Ï∫†ÌéòÏù∏ ÌïÑÌÑ∞ (ÌîÑÎ°úÎ™®ÏÖòÏùò ÌïòÏúÑ)
        function updateCampaignFilter() {
            const filteredData = allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                if (filters.brand && row['Î∏åÎûúÎìúÎ™Ö'] !== filters.brand) return false;
                if (filters.product && row['ÏÉÅÌíàÎ™Ö'] !== filters.product) return false;
                if (filters.promotion && row['ÌîÑÎ°úÎ™®ÏÖò'] !== filters.promotion) return false;
                return true;
            });
            const campaigns = [...new Set(filteredData.map(d => d['Ï∫†ÌéòÏù∏']))].filter(Boolean).sort();
            const campaignSelect = document.getElementById('filterCampaign');
            campaignSelect.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            campaigns.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                campaignSelect.appendChild(option);
            });
            if (!campaigns.includes(filters.campaign)) {
                filters.campaign = '';
                campaignSelect.value = '';
            }
            updateAdSetFilter();
        }

        // Í¥ëÍ≥†ÏÑ∏Ìä∏ ÌïÑÌÑ∞ (Ï∫†ÌéòÏù∏Ïùò ÌïòÏúÑ)
        function updateAdSetFilter() {
            const filteredData = allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                if (filters.brand && row['Î∏åÎûúÎìúÎ™Ö'] !== filters.brand) return false;
                if (filters.product && row['ÏÉÅÌíàÎ™Ö'] !== filters.product) return false;
                if (filters.promotion && row['ÌîÑÎ°úÎ™®ÏÖò'] !== filters.promotion) return false;
                if (filters.campaign && row['Ï∫†ÌéòÏù∏'] !== filters.campaign) return false;
                return true;
            });
            const adSets = [...new Set(filteredData.map(d => d['Í¥ëÍ≥†ÏÑ∏Ìä∏']))].filter(Boolean).sort();
            const adSetSelect = document.getElementById('filterAdSet');
            adSetSelect.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            adSets.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                adSetSelect.appendChild(option);
            });
            if (!adSets.includes(filters.adSet)) {
                filters.adSet = '';
                adSetSelect.value = '';
            }
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                select.appendChild(option);
            });
        }

        // ÎÇ†Ïßú Î≤îÏúÑ ÏÑ§Ï†ï
        function setDateRange() {
            const dates = allData
                .map(d => d['ÎÇ†Ïßú'])
                .filter(Boolean)
                .map(d => new Date(d))
                .filter(d => !isNaN(d));

            if (dates.length > 0) {
                const minDate = new Date(Math.min(...dates));
                const maxDate = new Date(Math.max(...dates));

                document.getElementById('startDate').value = formatDateForInput(minDate);
                document.getElementById('endDate').value = formatDateForInput(maxDate);

                filters.startDate = formatDateForInput(minDate);
                filters.endDate = formatDateForInput(maxDate);
            }
        }

        function formatDateForInput(date) {
            return date.toISOString().split('T')[0];
        }

        // Îç∞Ïù¥ÌÑ∞ ÌïÑÌÑ∞ÎßÅ
        function filterData() {
            return allData.filter(row => {
                if (filters.type && row['Ïú†ÌòïÍµ¨Î∂Ñ'] !== filters.type) return false;
                if (filters.brand && row['Î∏åÎûúÎìúÎ™Ö'] !== filters.brand) return false;
                if (filters.product && row['ÏÉÅÌíàÎ™Ö'] !== filters.product) return false;
                if (filters.promotion && row['ÌîÑÎ°úÎ™®ÏÖò'] !== filters.promotion) return false;
                if (filters.campaign && row['Ï∫†ÌéòÏù∏'] !== filters.campaign) return false;
                if (filters.adSet && row['Í¥ëÍ≥†ÏÑ∏Ìä∏'] !== filters.adSet) return false;

                if (filters.startDate || filters.endDate) {
                    const rowDate = new Date(row['ÎÇ†Ïßú']);
                    if (isNaN(rowDate)) return false;
                    if (filters.startDate && rowDate < new Date(filters.startDate)) return false;
                    if (filters.endDate && rowDate > new Date(filters.endDate)) return false;
                }

                return true;
            });
        }

        // ÏÜåÏû¨Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏßëÍ≥Ñ (ÏÜåÏû¨Ïù¥Î¶Ñ Í∏∞Ï§Ä)
        function aggregateByCreative(data) {
            const groups = {};

            data.forEach(row => {
                const key = row['ÏÜåÏû¨Ïù¥Î¶Ñ'] || 'Í∏∞ÌÉÄ';

                if (!groups[key]) {
                    groups[key] = {
                        name: key,
                        ÎπÑÏö©: 0,
                        ÎÖ∏Ï∂ú: 0,
                        ÌÅ¥Î¶≠: 0,
                        Ï†ÑÌôòÏàò: 0,
                        Ï†ÑÌôòÍ∞í: 0
                    };
                }

                groups[key].ÎπÑÏö© += parseFloat(row['ÎπÑÏö©']) || 0;
                groups[key].ÎÖ∏Ï∂ú += parseFloat(row['ÎÖ∏Ï∂ú']) || 0;
                groups[key].ÌÅ¥Î¶≠ += parseFloat(row['ÌÅ¥Î¶≠']) || 0;
                groups[key].Ï†ÑÌôòÏàò += parseFloat(row['Ï†ÑÌôòÏàò']) || 0;
                groups[key].Ï†ÑÌôòÍ∞í += parseFloat(row['Ï†ÑÌôòÍ∞í']) || 0;
            });

            // KPI Í≥ÑÏÇ∞
            return Object.values(groups).map(g => ({
                ...g,
                CPM: g.ÎÖ∏Ï∂ú > 0 ? (g.ÎπÑÏö© / g.ÎÖ∏Ï∂ú * 1000) : 0,
                CPC: g.ÌÅ¥Î¶≠ > 0 ? (g.ÎπÑÏö© / g.ÌÅ¥Î¶≠) : 0,
                CPA: g.Ï†ÑÌôòÏàò > 0 ? (g.ÎπÑÏö© / g.Ï†ÑÌôòÏàò) : 0,
                ROAS: g.ÎπÑÏö© > 0 ? (g.Ï†ÑÌôòÍ∞í / g.ÎπÑÏö© * 100) : 0
            })).sort((a, b) => {
                const aVal = a[sortConfig.metric];
                const bVal = b[sortConfig.metric];
                return sortConfig.order === 'desc' ? bVal - aVal : aVal - bVal;
            });
        }

        // Í∏∞Í∞Ñ Î∞è Í∏∞Î≥∏ ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetBasicFilters() {
            setDateRange();
            filters.type = '';
            filters.brand = '';
            filters.product = '';
            filters.promotion = '';
            document.getElementById('filterType').value = '';
            document.getElementById('filterBrand').value = '';
            document.getElementById('filterProduct').value = '';
            document.getElementById('filterPromotion').value = '';
            updateBrandFilter();
            updateDashboard();
        }

        // ÏÑ∏Î∂Ä ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetDetailFilters() {
            filters.campaign = '';
            filters.adSet = '';
            filters.searchText = '';
            document.getElementById('filterCampaign').value = '';
            document.getElementById('filterAdSet').value = '';
            document.getElementById('searchText').value = '';
            updateDashboard();
        }

        // ÎåÄÏãúÎ≥¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
        function updateDashboard() {
            const filteredData = filterData();
            let creativeData = aggregateByCreative(filteredData);

            // ÏÜåÏû¨ Í≤ÄÏÉâ ÌïÑÌÑ∞ Ï†ÅÏö© (LIKE '%Í≤ÄÏÉâÏñ¥%')
            if (filters.searchText) {
                const searchLower = filters.searchText.toLowerCase();
                creativeData = creativeData.filter(creative =>
                    creative.name.toLowerCase().includes(searchLower)
                );
            }

            // KPI Í∏∞Ï§Ä ÌïÑÌÑ∞ Ï†ÅÏö©
            if (kpiFilter.enabled && kpiFilter.value !== '') {
                const targetValue = parseFloat(kpiFilter.value);
                if (!isNaN(targetValue)) {
                    // Î©îÌä∏Î¶≠ Í∞í Í∞ÄÏ†∏Ïò§Í∏∞ Ìó¨Ìçº Ìï®Ïàò
                    const getMetricValue = (creative, metric) => {
                        switch (metric) {
                            case 'ÎπÑÏö©': return creative.ÎπÑÏö©;
                            case 'ÎÖ∏Ï∂ú': return creative.ÎÖ∏Ï∂ú;
                            case 'ÌÅ¥Î¶≠': return creative.ÌÅ¥Î¶≠;
                            case 'Ï†ÑÌôòÏàò': return creative.Ï†ÑÌôòÏàò;
                            case 'Ï†ÑÌôòÍ∞í': return creative.Ï†ÑÌôòÍ∞í;
                            case 'CPC': return creative.CPC;
                            case 'CPA': return creative.CPA;
                            case 'ROAS': return creative.ROAS;
                            default: return 0;
                        }
                    };

                    // ÎπÑÍµê Ïó∞ÏÇ∞ Ìó¨Ìçº Ìï®Ïàò
                    const compareValues = (metricValue, operator, targetVal) => {
                        switch (operator) {
                            case '>': return metricValue > targetVal;
                            case '<': return metricValue < targetVal;
                            case '>=': return metricValue >= targetVal;
                            case '<=': return metricValue <= targetVal;
                            case '=': return metricValue === targetVal;
                            default: return true;
                        }
                    };

                    creativeData = creativeData.filter(creative => {
                        // Í∏∞Î≥∏ Ï°∞Í±¥ ÌèâÍ∞Ä
                        const metricValue = getMetricValue(creative, kpiFilter.metric);
                        const primaryResult = compareValues(metricValue, kpiFilter.operator, targetValue);

                        // Î≥µÌï© Ï°∞Í±¥Ïù¥ ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ Ï°∞Í±¥Îßå Î∞òÌôò
                        if (kpiFilter.compoundLogic === 'none') {
                            return primaryResult;
                        }

                        // Î≥¥Ï°∞ Ï°∞Í±¥ ÌèâÍ∞Ä
                        const secondaryTargetValue = parseFloat(kpiFilter.secondaryValue);
                        let secondaryResult = true;
                        if (!isNaN(secondaryTargetValue) && kpiFilter.secondaryValue !== '') {
                            const secondaryMetricValue = getMetricValue(creative, kpiFilter.secondaryMetric);
                            secondaryResult = compareValues(secondaryMetricValue, kpiFilter.secondaryOperator, secondaryTargetValue);
                        }

                        // 3Ï∞® Ï°∞Í±¥ ÌèâÍ∞Ä (secondaryCompoundLogicÏù¥ ÏÑ§Ï†ïÎêú Í≤ΩÏö∞ÏóêÎßå)
                        let tertiaryResult = true;
                        let hasTertiaryCondition = false;
                        if (kpiFilter.secondaryCompoundLogic !== 'none') {
                            const tertiaryTargetValue = parseFloat(kpiFilter.tertiaryValue);
                            if (!isNaN(tertiaryTargetValue) && kpiFilter.tertiaryValue !== '') {
                                hasTertiaryCondition = true;
                                const tertiaryMetricValue = getMetricValue(creative, kpiFilter.tertiaryMetric);
                                tertiaryResult = compareValues(tertiaryMetricValue, kpiFilter.tertiaryOperator, tertiaryTargetValue);
                            }
                        }

                        // OR ÎòêÎäî AND Ïó∞ÏÇ∞ (1Ï∞®-2Ï∞® Ï°∞Í±¥)
                        let result12;
                        if (kpiFilter.compoundLogic === 'or') {
                            result12 = primaryResult || (kpiFilter.secondaryValue !== '' ? secondaryResult : false);
                        } else if (kpiFilter.compoundLogic === 'and') {
                            result12 = primaryResult && (kpiFilter.secondaryValue !== '' ? secondaryResult : true);
                        } else {
                            return primaryResult;
                        }

                        // 3Ï∞® Ï°∞Í±¥ Ï†ÅÏö© (secondaryCompoundLogic Í∏∞Î∞ò)
                        if (hasTertiaryCondition) {
                            if (kpiFilter.secondaryCompoundLogic === 'or') {
                                return result12 || tertiaryResult;
                            } else if (kpiFilter.secondaryCompoundLogic === 'and') {
                                return result12 && tertiaryResult;
                            }
                        }

                        return result12;
                    });
                }
            }

            // ÏöîÏïΩ ÏóÖÎç∞Ïù¥Ìä∏
            updateSummary(creativeData);

            // ÏÜåÏû¨ Í∑∏Î¶¨Îìú ÏóÖÎç∞Ïù¥Ìä∏
            updateCreativeGrid(creativeData);
        }

        // ÏöîÏïΩ ÏóÖÎç∞Ïù¥Ìä∏
        function updateSummary(data) {
            const totals = data.reduce((acc, row) => {
                acc.ÎπÑÏö© += row.ÎπÑÏö©;
                acc.ÎÖ∏Ï∂ú += row.ÎÖ∏Ï∂ú;
                acc.ÌÅ¥Î¶≠ += row.ÌÅ¥Î¶≠;
                acc.Ï†ÑÌôòÏàò += row.Ï†ÑÌôòÏàò;
                acc.Ï†ÑÌôòÍ∞í += row.Ï†ÑÌôòÍ∞í;
                return acc;
            }, { ÎπÑÏö©: 0, ÎÖ∏Ï∂ú: 0, ÌÅ¥Î¶≠: 0, Ï†ÑÌôòÏàò: 0, Ï†ÑÌôòÍ∞í: 0 });

            const avgCPM = totals.ÎÖ∏Ï∂ú > 0 ? (totals.ÎπÑÏö© / totals.ÎÖ∏Ï∂ú * 1000) : 0;
            const avgCPC = totals.ÌÅ¥Î¶≠ > 0 ? (totals.ÎπÑÏö© / totals.ÌÅ¥Î¶≠) : 0;
            const avgCPA = totals.Ï†ÑÌôòÏàò > 0 ? (totals.ÎπÑÏö© / totals.Ï†ÑÌôòÏàò) : 0;
            const avgROAS = totals.ÎπÑÏö© > 0 ? (totals.Ï†ÑÌôòÍ∞í / totals.ÎπÑÏö© * 100) : 0;

            document.getElementById('totalCost').textContent = formatNumber(totals.ÎπÑÏö©);
            document.getElementById('avgCPM').textContent = formatNumber(avgCPM);
            document.getElementById('avgCPC').textContent = formatNumber(avgCPC);
            document.getElementById('avgCPA').textContent = formatNumber(avgCPA);
            document.getElementById('avgROAS').textContent = formatROAS(avgROAS);
        }

        // ÏÜåÏû¨ Í∑∏Î¶¨Îìú ÏóÖÎç∞Ïù¥Ìä∏
        function updateCreativeGrid(data) {
            const grid = document.getElementById('creativeGrid');

            if (data.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <svg viewBox="0 0 24 24">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                        </svg>
                        <h3>ÏÜåÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</h3>
                        <p>ÌïÑÌÑ∞ Ï°∞Í±¥ÏùÑ Î≥ÄÍ≤ΩÌï¥ Ï£ºÏÑ∏Ïöî</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = data.map(creative => {
                // Ïù¥ÎØ∏ÏßÄ URL Îß§ÌïëÏóêÏÑú ÏÜåÏû¨Ïù¥Î¶ÑÏúºÎ°ú URL Ï∞æÍ∏∞
                const imageUrl = imageUrlMap[creative.name];
                const fallbackUrl = fallbackUrlMap[creative.name];
                const originalUrl = originalUrlMap[creative.name];

                // ÌÅ¥Î¶≠ Í∞ÄÎä• Ïó¨Î∂Ä Î∞è ÎßÅÌÅ¨ URL Í≤∞Ï†ï
                const hasLink = originalUrl || imageUrl;
                const linkUrl = originalUrl || imageUrl || '#';

                // onerror Ìï∏Îì§Îü¨: fallback URLÏù¥ ÏûàÏúºÎ©¥ ÏãúÎèÑ, ÏóÜÏúºÎ©¥ placeholder ÌëúÏãú
                const errorHandler = fallbackUrl
                    ? `onerror="if(!this.dataset.tried){this.dataset.tried='1';this.src='${fallbackUrl}';}else{this.style.display='none';this.nextElementSibling.style.display='block';}"`
                    : `onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"`;

                const imageContent = imageUrl
                    ? `<img src="${imageUrl}" alt="${creative.name}" class="creative-image" ${errorHandler}>
                       <div class="creative-placeholder" style="display: none;">
                           <svg viewBox="0 0 24 24">
                               <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                           </svg>
                           <div>Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®</div>
                       </div>`
                    : `<div class="creative-placeholder">
                           <svg viewBox="0 0 24 24">
                               <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                           </svg>
                           <div>Ïù¥ÎØ∏ÏßÄ ÏóÜÏùå</div>
                       </div>`;

                // Ïù¥ÎØ∏ÏßÄ ÏòÅÏó≠ÏùÑ ÎßÅÌÅ¨Î°ú Í∞êÏã∏Í∏∞
                const imageWrapper = hasLink
                    ? `<a href="${linkUrl}" target="_blank" rel="noopener noreferrer" class="creative-image-link" title="ÏõêÎ≥∏ Î≥¥Í∏∞">
                           <div class="creative-image-wrapper">
                               ${imageContent}
                           </div>
                       </a>`
                    : `<div class="creative-image-wrapper">
                           ${imageContent}
                       </div>`;

                return `
                <div class="creative-card card">
                    ${imageWrapper}
                    <div class="creative-info">
                        <div class="creative-name clickable" title="${creative.name}" onclick="showCreativeDetail('${creative.name.replace(/'/g, "\\'")}')">${creative.name}</div>
                        <div class="creative-metrics">
                            <div class="creative-metric">
                                <span class="metric-label">ÎπÑÏö©</span>
                                <span class="metric-value">${formatNumber(creative.ÎπÑÏö©)}</span>
                            </div>
                            <div class="creative-metric">
                                <span class="metric-label">CPC</span>
                                <span class="metric-value">${formatNumber(creative.CPC)}</span>
                            </div>
                            <div class="creative-metric">
                                <span class="metric-label">CPA</span>
                                <span class="metric-value">${formatNumber(creative.CPA)}</span>
                            </div>
                            <div class="creative-metric">
                                <span class="metric-label">ROAS</span>
                                <span class="metric-value ${creative.ROAS >= 100 ? 'positive' : 'negative'}">${formatROAS(creative.ROAS)}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        // Ïà´Ïûê Ìè¨Îß∑
        function formatNumber(num) {
            if (num === 0 || num === null || num === undefined) return '-';
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // ROAS Ìè¨Îß∑
        function formatROAS(num) {
            if (num === 0 || num === null || num === undefined) return '-';
            return Math.round(num) + '%';
        }

        // CTR Ìè¨Îß∑ (ÏÜåÏàòÏ†ê 2ÏûêÎ¶¨)
        function formatCTR(num) {
            if (num === 0 || num === null || num === undefined) return '-';
            return num.toFixed(2) + '%';
        }

        // Î™®Îã¨ Í¥ÄÎ†® Ï†ÑÏó≠ Î≥ÄÏàò
        let modalChartInstance = null;
        let currentModalData = [];
        let currentModalViewType = 'daily';
        let isModalTableExpanded = false;
        let modalTableSortOrder = 'desc'; // 'desc': ÎÇ¥Î¶ºÏ∞®Ïàú(ÏµúÏã†Ïàú), 'asc': Ïò§Î¶ÑÏ∞®Ïàú(Í≥ºÍ±∞Ïàú)
        let showModalDataLabels = false;

        // ÏÜåÏû¨ ÏÑ∏Î∂Ä ÏÑ±Í≥º Î™®Îã¨ ÌëúÏãú
        function showCreativeDetail(creativeName) {
            // Ìï¥Îãπ ÏÜåÏû¨Ïùò Îç∞Ïù¥ÌÑ∞ ÌïÑÌÑ∞ÎßÅ
            const creativeData = filterData().filter(row => row['ÏÜåÏû¨Ïù¥Î¶Ñ'] === creativeName);

            if (creativeData.length === 0) {
                alert('Ìï¥Îãπ ÏÜåÏû¨Ïùò Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }

            // Î™®Îã¨ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            currentModalData = creativeData;
            currentModalViewType = 'daily';
            isModalTableExpanded = false;
            modalTableSortOrder = 'desc'; // Ï†ïÎ†¨ ÏàúÏÑú Ï¥àÍ∏∞Ìôî (ÎÇ¥Î¶ºÏ∞®Ïàú)

            // Î∑∞ ÌÉÄÏûÖ Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
            document.querySelectorAll('.modal-view-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.view === 'daily') btn.classList.add('active');
            });

            // Î™®Îã¨ Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('modalTitle').textContent = creativeName;

            // Î™®Îã¨ ÎÇ¥Ïö© ÏóÖÎç∞Ïù¥Ìä∏
            updateModalContent();

            // Î™®Îã¨ ÌëúÏãú
            document.getElementById('creativeModal').classList.add('active');
        }

        // Î∑∞ ÌÉÄÏûÖ Î≥ÄÍ≤Ω
        function changeModalViewType(viewType) {
            currentModalViewType = viewType;
            isModalTableExpanded = false;
            modalTableSortOrder = 'desc'; // Ï†ïÎ†¨ ÏàúÏÑú Ï¥àÍ∏∞Ìôî

            // Î≤ÑÌäº ÌôúÏÑ±Ìôî ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.querySelectorAll('.modal-view-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.view === viewType) btn.classList.add('active');
            });

            // Î™®Îã¨ ÎÇ¥Ïö© ÏóÖÎç∞Ïù¥Ìä∏
            updateModalContent();
        }

        // Î™®Îã¨ ÎÇ¥Ïö© ÏóÖÎç∞Ïù¥Ìä∏
        function updateModalContent() {
            // Îç∞Ïù¥ÌÑ∞ ÏßëÍ≥Ñ
            const aggregatedData = aggregateModalData(currentModalData, currentModalViewType);

            // KPI ÏßëÍ≥Ñ
            const totals = currentModalData.reduce((acc, row) => {
                acc.ÎπÑÏö© += parseFloat(row['ÎπÑÏö©']) || 0;
                acc.ÎÖ∏Ï∂ú += parseFloat(row['ÎÖ∏Ï∂ú']) || 0;
                acc.ÌÅ¥Î¶≠ += parseFloat(row['ÌÅ¥Î¶≠']) || 0;
                acc.Ï†ÑÌôòÏàò += parseFloat(row['Ï†ÑÌôòÏàò']) || 0;
                acc.Ï†ÑÌôòÍ∞í += parseFloat(row['Ï†ÑÌôòÍ∞í']) || 0;
                return acc;
            }, { ÎπÑÏö©: 0, ÎÖ∏Ï∂ú: 0, ÌÅ¥Î¶≠: 0, Ï†ÑÌôòÏàò: 0, Ï†ÑÌôòÍ∞í: 0 });

            // ÌååÏÉù ÏßÄÌëú Í≥ÑÏÇ∞
            const kpis = {
                ÎπÑÏö©: totals.ÎπÑÏö©,
                ÎÖ∏Ï∂ú: totals.ÎÖ∏Ï∂ú,
                ÌÅ¥Î¶≠: totals.ÌÅ¥Î¶≠,
                Ï†ÑÌôòÏàò: totals.Ï†ÑÌôòÏàò,
                Ï†ÑÌôòÍ∞í: totals.Ï†ÑÌôòÍ∞í,
                CPC: totals.ÌÅ¥Î¶≠ > 0 ? (totals.ÎπÑÏö© / totals.ÌÅ¥Î¶≠) : 0,
                CPA: totals.Ï†ÑÌôòÏàò > 0 ? (totals.ÎπÑÏö© / totals.Ï†ÑÌôòÏàò) : 0,
                ROAS: totals.ÎπÑÏö© > 0 ? (totals.Ï†ÑÌôòÍ∞í / totals.ÎπÑÏö© * 100) : 0
            };

            // KPI Ïπ¥Îìú Î†åÎçîÎßÅ (ÏÉÅÎã®: ÎπÑÏö©, CPC, CPA, ROAS / ÌïòÎã®: ÎÖ∏Ï∂ú, ÌÅ¥Î¶≠, Ï†ÑÌôòÏàò, Ï†ÑÌôòÍ∞í)
            document.getElementById('modalKpiRowTop').innerHTML = `
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">ÎπÑÏö©</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.ÎπÑÏö©)}Ïõê</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">CPC</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.CPC)}Ïõê</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">CPA</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.CPA)}Ïõê</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">ROAS</div>
                    <div class="modal-kpi-value">${formatROAS(kpis.ROAS)}</div>
                </div>
            `;

            document.getElementById('modalKpiRowBottom').innerHTML = `
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">ÎÖ∏Ï∂ú</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.ÎÖ∏Ï∂ú)}</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">ÌÅ¥Î¶≠</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.ÌÅ¥Î¶≠)}</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">Ï†ÑÌôòÏàò</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.Ï†ÑÌôòÏàò)}</div>
                </div>
                <div class="modal-kpi-card">
                    <div class="modal-kpi-label">Ï†ÑÌôòÍ∞í</div>
                    <div class="modal-kpi-value">${formatNumber(kpis.Ï†ÑÌôòÍ∞í)}Ïõê</div>
                </div>
            `;

            // ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
            updateModalTable(aggregatedData);

            // Ï†ïÎ†¨ ÏïÑÏù¥ÏΩò ÏóÖÎç∞Ïù¥Ìä∏
            updateModalSortIcon();

            // Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            updateModalChart();
        }

        // Î™®Îã¨ Îç∞Ïù¥ÌÑ∞ ÏßëÍ≥Ñ (ÏùºÎ≥Ñ/Ï£ºÎ≥Ñ/ÏõîÎ≥Ñ)
        function aggregateModalData(data, viewType) {
            const groups = {};

            data.forEach(row => {
                let key;
                const date = new Date(row['ÎÇ†Ïßú']);

                if (viewType === 'daily') {
                    key = row['ÎÇ†Ïßú'];
                } else if (viewType === 'weekly') {
                    // Ï£º ÏãúÏûëÏùº (ÏõîÏöîÏùº) Í≥ÑÏÇ∞
                    const day = date.getDay();
                    const diff = date.getDate() - day + (day === 0 ? -6 : 1);
                    const monday = new Date(date.setDate(diff));
                    key = formatDateForInput(monday);
                } else if (viewType === 'monthly') {
                    key = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                }

                if (!groups[key]) {
                    groups[key] = { ÎπÑÏö©: 0, ÎÖ∏Ï∂ú: 0, ÌÅ¥Î¶≠: 0, Ï†ÑÌôòÏàò: 0, Ï†ÑÌôòÍ∞í: 0 };
                }

                groups[key].ÎπÑÏö© += parseFloat(row['ÎπÑÏö©']) || 0;
                groups[key].ÎÖ∏Ï∂ú += parseFloat(row['ÎÖ∏Ï∂ú']) || 0;
                groups[key].ÌÅ¥Î¶≠ += parseFloat(row['ÌÅ¥Î¶≠']) || 0;
                groups[key].Ï†ÑÌôòÏàò += parseFloat(row['Ï†ÑÌôòÏàò']) || 0;
                groups[key].Ï†ÑÌôòÍ∞í += parseFloat(row['Ï†ÑÌôòÍ∞í']) || 0;
            });

            // ÌååÏÉù ÏßÄÌëú Í≥ÑÏÇ∞ Î∞è Ï†ïÎ†¨ (modalTableSortOrderÏóê Îî∞Îùº)
            return Object.entries(groups)
                .map(([period, values]) => ({
                    period,
                    ...values,
                    CPM: values.ÎÖ∏Ï∂ú > 0 ? (values.ÎπÑÏö© / values.ÎÖ∏Ï∂ú * 1000) : 0,
                    CTR: values.ÎÖ∏Ï∂ú > 0 ? (values.ÌÅ¥Î¶≠ / values.ÎÖ∏Ï∂ú * 100) : 0,
                    CPC: values.ÌÅ¥Î¶≠ > 0 ? (values.ÎπÑÏö© / values.ÌÅ¥Î¶≠) : 0,
                    CPA: values.Ï†ÑÌôòÏàò > 0 ? (values.ÎπÑÏö© / values.Ï†ÑÌôòÏàò) : 0,
                    ROAS: values.ÎπÑÏö© > 0 ? (values.Ï†ÑÌôòÍ∞í / values.ÎπÑÏö© * 100) : 0
                }))
                .sort((a, b) => modalTableSortOrder === 'desc'
                    ? b.period.localeCompare(a.period)
                    : a.period.localeCompare(b.period));
        }

        // Î™®Îã¨ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateModalTable(data) {
            const tbody = document.getElementById('modalTableBody');
            const showMoreContainer = document.getElementById('modalShowMoreContainer');
            const collapseContainer = document.getElementById('modalCollapseContainer');
            const hiddenCount = document.getElementById('modalHiddenCount');

            // ÌÖåÏù¥Î∏î Ìñâ ÏÉùÏÑ±
            tbody.innerHTML = data.map((row, index) => {
                const displayStyle = (!isModalTableExpanded && index >= 5) ? 'display: none;' : '';
                return `
                    <tr style="${displayStyle}">
                        <td>${formatPeriodLabel(row.period, currentModalViewType)}</td>
                        <td>${formatNumber(row.ÎπÑÏö©)}</td>
                        <td>${formatNumber(row.ÎÖ∏Ï∂ú)}</td>
                        <td>${formatNumber(row.CPM)}</td>
                        <td>${formatNumber(row.ÌÅ¥Î¶≠)}</td>
                        <td>${formatCTR(row.CTR)}</td>
                        <td>${formatNumber(row.CPC)}</td>
                        <td>${formatNumber(row.Ï†ÑÌôòÏàò)}</td>
                        <td>${formatNumber(row.CPA)}</td>
                        <td>${formatNumber(row.Ï†ÑÌôòÍ∞í)}</td>
                        <td>${formatROAS(row.ROAS)}</td>
                    </tr>
                `;
            }).join('');

            // ÎçîÎ≥¥Í∏∞/Ï†ëÍ∏∞ Î≤ÑÌäº ÌëúÏãú
            if (data.length > 5) {
                if (isModalTableExpanded) {
                    showMoreContainer.style.display = 'none';
                    collapseContainer.style.display = 'block';
                } else {
                    hiddenCount.textContent = data.length - 5;
                    showMoreContainer.style.display = 'block';
                    collapseContainer.style.display = 'none';
                }
            } else {
                showMoreContainer.style.display = 'none';
                collapseContainer.style.display = 'none';
            }
        }

        // Í∏∞Í∞Ñ Î†àÏù¥Î∏î Ìè¨Îß∑
        function formatPeriodLabel(period, viewType) {
            if (viewType === 'monthly') {
                const [year, month] = period.split('-');
                return `${year}ÎÖÑ ${parseInt(month)}Ïõî`;
            } else if (viewType === 'weekly') {
                const date = new Date(period);
                const endDate = new Date(date);
                endDate.setDate(endDate.getDate() + 6);
                return `${date.getMonth() + 1}/${date.getDate()} ~ ${endDate.getMonth() + 1}/${endDate.getDate()}`;
            } else {
                const date = new Date(period);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            }
        }

        // Î™®Îã¨ ÌÖåÏù¥Î∏î ÌéºÏπòÍ∏∞
        function expandModalTable() {
            isModalTableExpanded = true;
            const aggregatedData = aggregateModalData(currentModalData, currentModalViewType);
            updateModalTable(aggregatedData);
        }

        // Î™®Îã¨ ÌÖåÏù¥Î∏î Ï†ëÍ∏∞
        function collapseModalTable() {
            isModalTableExpanded = false;
            const aggregatedData = aggregateModalData(currentModalData, currentModalViewType);
            updateModalTable(aggregatedData);
        }

        // Î™®Îã¨ ÌÖåÏù¥Î∏î Ï†ïÎ†¨ ÌÜ†Í∏Ä
        function toggleModalTableSort() {
            // Ï†ïÎ†¨ ÏàúÏÑú ÌÜ†Í∏Ä
            modalTableSortOrder = modalTableSortOrder === 'desc' ? 'asc' : 'desc';

            // Îç∞Ïù¥ÌÑ∞ Ïû¨ÏßëÍ≥Ñ Î∞è ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
            const aggregatedData = aggregateModalData(currentModalData, currentModalViewType);
            updateModalTable(aggregatedData);

            // Ï†ïÎ†¨ ÏïÑÏù¥ÏΩò ÏóÖÎç∞Ïù¥Ìä∏
            updateModalSortIcon();
        }

        // Ï†ïÎ†¨ ÏïÑÏù¥ÏΩò ÏóÖÎç∞Ïù¥Ìä∏
        function updateModalSortIcon() {
            const sortIcon = document.getElementById('modalSortIcon');
            if (sortIcon) {
                sortIcon.textContent = modalTableSortOrder === 'desc' ? '‚ñº' : '‚ñ≤';
            }
        }

        // Î™®Îã¨ Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
        function updateModalChart() {
            const aggregatedData = aggregateModalData(currentModalData, currentModalViewType);

            // Ïò§Î¶ÑÏ∞®ÏàúÏúºÎ°ú Ï†ïÎ†¨ (Ï∞®Ìä∏Ïö©)
            const sortedData = [...aggregatedData].sort((a, b) => a.period.localeCompare(b.period));

            const chartLabels = sortedData.map(d => formatPeriodLabel(d.period, currentModalViewType));

            // Ï≤¥ÌÅ¨Î∞ïÏä§ ÏÉÅÌÉú ÌôïÏù∏
            const showCost = document.getElementById('modalChartCost').checked;
            const showCPM = document.getElementById('modalChartCPM').checked;
            const showCPC = document.getElementById('modalChartCPC').checked;
            const showCPA = document.getElementById('modalChartCPA').checked;
            const showROAS = document.getElementById('modalChartROAS').checked;

            // YÏ∂ï Í≤∞Ï†ï Î°úÏßÅ (Î™®Îì† Ï°∞Ìï© Í≥†Î†§)
            // Ïö∞ÏÑ†ÏàúÏúÑ: ÎπÑÏö© > CPM > CPC > CPA > ROAS
            // Ï≤´ Î≤àÏß∏ ÏßÄÌëúÎäî ÏôºÏ™Ω, ÎÇòÎ®∏ÏßÄÎäî Ïò§Î•∏Ï™Ω
            const hasCostMetric = showCost;
            const hasCpmMetric = showCPM;
            const hasCpcMetric = showCPC;
            const hasCpaMetric = showCPA;

            // Ïò§Î•∏Ï™Ω Ï∂ï ÏÇ¨Ïö© Ïó¨Î∂Ä Í≤∞Ï†ï (2Í∞ú Ïù¥ÏÉÅ ÏßÄÌëú ÏÑ†ÌÉù Ïãú)
            const selectedCount = (showCost ? 1 : 0) + (showCPM ? 1 : 0) + (showCPC ? 1 : 0) + (showCPA ? 1 : 0) + (showROAS ? 1 : 0);
            const useRightAxis = selectedCount >= 2;

            // Îç∞Ïù¥ÌÑ∞ÏÖã ÏÉùÏÑ±
            const datasets = [];

            if (showCost) {
                datasets.push({
                    label: 'ÎπÑÏö©',
                    data: sortedData.map(d => d.ÎπÑÏö©),
                    borderColor: '#673ab7',
                    backgroundColor: 'rgba(103, 58, 183, 0.1)',
                    yAxisID: 'y',
                    tension: 0.3,
                    fill: true
                });
            }

            if (showCPM) {
                // CPM: ÎπÑÏö©Ïù¥ ÏûàÏúºÎ©¥ Ïò§Î•∏Ï™Ω, ÏóÜÏúºÎ©¥ ÏôºÏ™Ω
                datasets.push({
                    label: 'CPM',
                    data: sortedData.map(d => d.CPM),
                    borderColor: '#9c27b0',
                    backgroundColor: 'rgba(156, 39, 176, 0.1)',
                    yAxisID: hasCostMetric ? 'y1' : 'y',
                    tension: 0.3,
                    fill: false
                });
            }

            if (showCPC) {
                // CPC: ÎπÑÏö© ÎòêÎäî CPMÏù¥ ÏûàÏúºÎ©¥ Ïò§Î•∏Ï™Ω, ÏóÜÏúºÎ©¥ ÏôºÏ™Ω
                datasets.push({
                    label: 'CPC',
                    data: sortedData.map(d => d.CPC),
                    borderColor: '#2196f3',
                    backgroundColor: 'rgba(33, 150, 243, 0.1)',
                    yAxisID: (hasCostMetric || hasCpmMetric) ? 'y1' : 'y',
                    tension: 0.3,
                    fill: false
                });
            }

            if (showCPA) {
                // CPA: ÎπÑÏö©/CPM/CPC Ï§ë ÌïòÎÇòÎùºÎèÑ ÏûàÏúºÎ©¥ Ïò§Î•∏Ï™Ω, ÏóÜÏúºÎ©¥ ÏôºÏ™Ω
                datasets.push({
                    label: 'CPA',
                    data: sortedData.map(d => d.CPA),
                    borderColor: '#ff9800',
                    backgroundColor: 'rgba(255, 152, 0, 0.1)',
                    yAxisID: (hasCostMetric || hasCpmMetric || hasCpcMetric) ? 'y1' : 'y',
                    tension: 0.3,
                    fill: false
                });
            }

            if (showROAS) {
                // ROAS: ÎπÑÏö©/CPM/CPC/CPA Ï§ë ÌïòÎÇòÎùºÎèÑ ÏûàÏúºÎ©¥ Ïò§Î•∏Ï™Ω, ROASÎßå ÏûàÏúºÎ©¥ ÏôºÏ™Ω
                datasets.push({
                    label: 'ROAS',
                    data: sortedData.map(d => d.ROAS),
                    borderColor: '#00c853',
                    backgroundColor: 'rgba(0, 200, 83, 0.1)',
                    yAxisID: (hasCostMetric || hasCpmMetric || hasCpcMetric || hasCpaMetric) ? 'y1' : 'y',
                    tension: 0.3,
                    fill: false
                });
            }

            // Ï∞®Ìä∏ ÏÉùÏÑ±/ÏóÖÎç∞Ïù¥Ìä∏
            const ctx = document.getElementById('modalChart').getContext('2d');

            if (modalChartInstance) {
                modalChartInstance.destroy();
            }

            modalChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartLabels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'ROAS') {
                                        label += Math.round(context.parsed.y) + '%';
                                    } else {
                                        label += formatNumber(context.parsed.y) + 'Ïõê';
                                    }
                                    return label;
                                }
                            }
                        },
                        datalabels: {
                            display: showModalDataLabels,
                            anchor: 'end',
                            align: 'top',
                            offset: 4,
                            font: {
                                family: "'Inter', sans-serif",
                                size: 11,
                                weight: '600'
                            },
                            color: function(context) {
                                return context.dataset.borderColor || context.dataset.backgroundColor;
                            },
                            formatter: function(value, context) {
                                if (context.dataset.label === 'ROAS') {
                                    return Math.round(value) + '%';
                                } else {
                                    return formatNumber(Math.round(value));
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: (function() {
                                    if (showCost) return 'ÎπÑÏö© (Ïõê)';
                                    if (showCPM) return 'CPM (Ïõê)';
                                    if (showCPC) return 'CPC (Ïõê)';
                                    if (showCPA) return 'CPA (Ïõê)';
                                    if (showROAS) return 'ROAS (%)';
                                    return 'Í∏àÏï° (Ïõê)';
                                })()
                            },
                            ticks: {
                                callback: function(value) {
                                    if (!showCost && !showCPM && !showCPC && !showCPA && showROAS) {
                                        return value + '%';
                                    }
                                    return formatNumber(value);
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: useRightAxis,
                            position: 'right',
                            title: {
                                display: true,
                                text: (function() {
                                    // Ïò§Î•∏Ï™Ω Ï∂ïÏóê ÏûàÎäî ÏßÄÌëúÎì§ ÌôïÏù∏
                                    const rightMetrics = [];
                                    if (hasCostMetric && showCPM) rightMetrics.push('CPM');
                                    if ((hasCostMetric || hasCpmMetric) && showCPC) rightMetrics.push('CPC');
                                    if ((hasCostMetric || hasCpmMetric || hasCpcMetric) && showCPA) rightMetrics.push('CPA');
                                    if ((hasCostMetric || hasCpmMetric || hasCpcMetric || hasCpaMetric) && showROAS) rightMetrics.push('ROAS');

                                    if (rightMetrics.length === 0) return '';
                                    if (rightMetrics.includes('ROAS') && rightMetrics.length === 1) return 'ROAS (%)';
                                    if (rightMetrics.includes('ROAS')) return rightMetrics.join('/');
                                    return rightMetrics.join('/') + ' (Ïõê)';
                                })()
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    // Ïò§Î•∏Ï™Ω Ï∂ïÏóê ROASÎßå ÏûàÏùÑ ÎïåÎäî % ÌëúÏãú
                                    const hasRightCPM = hasCostMetric && showCPM;
                                    const hasRightCPC = (hasCostMetric || hasCpmMetric) && showCPC;
                                    const hasRightCPA = (hasCostMetric || hasCpmMetric || hasCpcMetric) && showCPA;
                                    const hasRightROAS = (hasCostMetric || hasCpmMetric || hasCpcMetric || hasCpaMetric) && showROAS;

                                    if (hasRightROAS && !hasRightCPM && !hasRightCPC && !hasRightCPA) {
                                        return value + '%';
                                    }
                                    return formatNumber(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        // Î™®Îã¨ Îã´Í∏∞
        function closeModal(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('creativeModal').classList.remove('active');
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        document.addEventListener('DOMContentLoaded', () => {
            loadData();

            // Ï†ëÍ∏∞/ÌéºÏπòÍ∏∞ ÌÜ†Í∏Ä Í∏∞Îä•
            const filterCollapsibleHeader = document.getElementById('filterCollapsibleHeader');
            const filterCollapsibleContent = document.getElementById('filterCollapsibleContent');

            filterCollapsibleHeader.addEventListener('click', () => {
                const toggle = filterCollapsibleHeader.querySelector('.collapsible-toggle');
                const toggleText = toggle.querySelector('span:first-child');
                const toggleIcon = toggle.querySelector('.collapsible-toggle-icon');

                if (filterCollapsibleContent.classList.contains('expanded')) {
                    filterCollapsibleContent.classList.remove('expanded');
                    toggleText.textContent = 'ÌéºÏπòÍ∏∞';
                    toggleIcon.classList.add('collapsed');
                } else {
                    filterCollapsibleContent.classList.add('expanded');
                    toggleText.textContent = 'Ï†ëÍ∏∞';
                    toggleIcon.classList.remove('collapsed');
                }
            });

            // ÌïÑÌÑ∞ Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏ (Í≥ÑÏ∏µ Íµ¨Ï°∞)
            document.getElementById('filterType').addEventListener('change', e => {
                filters.type = e.target.value;
                updateBrandFilter();
                updateDashboard();
            });

            document.getElementById('filterBrand').addEventListener('change', e => {
                filters.brand = e.target.value;
                updateProductFilter();
                updateDashboard();
            });

            document.getElementById('filterProduct').addEventListener('change', e => {
                filters.product = e.target.value;
                updatePromotionFilter();
                updateDashboard();
            });

            document.getElementById('filterPromotion').addEventListener('change', e => {
                filters.promotion = e.target.value;
                updateCampaignFilter();
                updateDashboard();
            });

            document.getElementById('filterCampaign').addEventListener('change', e => {
                filters.campaign = e.target.value;
                updateAdSetFilter();
                updateDashboard();
            });

            document.getElementById('filterAdSet').addEventListener('change', e => {
                filters.adSet = e.target.value;
                updateDashboard();
            });

            document.getElementById('startDate').addEventListener('change', e => {
                filters.startDate = e.target.value;
                updateDashboard();
            });

            document.getElementById('endDate').addEventListener('change', e => {
                filters.endDate = e.target.value;
                updateDashboard();
            });

            // ÏÜåÏû¨ Í≤ÄÏÉâ Ïù¥Î≤§Ìä∏ (ÏûÖÎ†• Ïãú Ïã§ÏãúÍ∞Ñ Í≤ÄÏÉâ)
            document.getElementById('searchText').addEventListener('input', e => {
                filters.searchText = e.target.value;
                updateDashboard();
            });

            // KPI ÌîÑÎ¶¨ÏÖã Ïù¥Î≤§Ìä∏
            document.getElementById('kpiPresetSelect').addEventListener('change', e => {
                applyKpiPreset(e.target.value);
            });

            // KPI ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏ (ÏàòÎèô Î≥ÄÍ≤Ω Ïãú ÌîÑÎ¶¨ÏÖã Ï¥àÍ∏∞Ìôî)
            document.getElementById('kpiFilterMetric').addEventListener('change', e => {
                kpiFilter.metric = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled) {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterOperator').addEventListener('change', e => {
                kpiFilter.operator = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled) {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterValue').addEventListener('input', e => {
                const formatted = formatNumberInput(e.target.value);
                e.target.value = formatted;
                kpiFilter.value = parseFormattedNumber(formatted);
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled) {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterToggle').addEventListener('click', e => {
                kpiFilter.enabled = !kpiFilter.enabled;
                const toggle = e.target.closest('.kpi-filter-toggle');
                const status = toggle.querySelector('.toggle-status');

                if (kpiFilter.enabled) {
                    toggle.classList.add('active');
                    status.textContent = 'ON';
                } else {
                    toggle.classList.remove('active');
                    status.textContent = 'OFF';
                }
                updateDashboard();
            });

            // Ï°∞Ìï© Ï°∞Í±¥ ÎùºÎîîÏò§ Î≤ÑÌäº Ïù¥Î≤§Ìä∏ (Ï°∞Í±¥1 -> Ï°∞Í±¥2)
            document.querySelectorAll('input[name="compoundLogic"]').forEach(radio => {
                radio.addEventListener('change', e => {
                    kpiFilter.compoundLogic = e.target.value;
                    document.getElementById('kpiPresetSelect').value = '';
                    document.getElementById('kpiPresetDescription').style.display = 'none';
                    const secondaryFilterRow = document.getElementById('secondaryFilterRow');
                    const tertiaryFilterRow = document.getElementById('tertiaryFilterRow');

                    if (e.target.value === 'none') {
                        secondaryFilterRow.style.display = 'none';
                        tertiaryFilterRow.style.display = 'none';
                        // Ï°∞Í±¥2Ïùò Ï°∞Ìï©Ï°∞Í±¥ÎèÑ Ï¥àÍ∏∞Ìôî
                        kpiFilter.secondaryCompoundLogic = 'none';
                        document.querySelector('input[name="compoundLogicSecondary"][value="none"]').checked = true;
                    } else {
                        secondaryFilterRow.style.display = 'flex';
                        // tertiaryFilterRowÎäî secondaryCompoundLogicÏóê ÏùòÌï¥ Ï†úÏñ¥Îê®
                    }

                    if (kpiFilter.enabled) {
                        updateDashboard();
                    }
                });
            });

            // Ï°∞Ìï© Ï°∞Í±¥ ÎùºÎîîÏò§ Î≤ÑÌäº Ïù¥Î≤§Ìä∏ (Ï°∞Í±¥2 -> Ï°∞Í±¥3)
            document.querySelectorAll('input[name="compoundLogicSecondary"]').forEach(radio => {
                radio.addEventListener('change', e => {
                    kpiFilter.secondaryCompoundLogic = e.target.value;
                    document.getElementById('kpiPresetSelect').value = '';
                    document.getElementById('kpiPresetDescription').style.display = 'none';
                    const tertiaryFilterRow = document.getElementById('tertiaryFilterRow');

                    if (e.target.value === 'none') {
                        tertiaryFilterRow.style.display = 'none';
                    } else {
                        tertiaryFilterRow.style.display = 'flex';
                    }

                    if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                        updateDashboard();
                    }
                });
            });

            // Î≥¥Ï°∞ ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏ (ÏàòÎèô Î≥ÄÍ≤Ω Ïãú ÌîÑÎ¶¨ÏÖã Ï¥àÍ∏∞Ìôî)
            document.getElementById('kpiFilterMetricSecondary').addEventListener('change', e => {
                kpiFilter.secondaryMetric = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterOperatorSecondary').addEventListener('change', e => {
                kpiFilter.secondaryOperator = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterValueSecondary').addEventListener('input', e => {
                const formatted = formatNumberInput(e.target.value);
                e.target.value = formatted;
                kpiFilter.secondaryValue = parseFormattedNumber(formatted);
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            // 3Ï∞® ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏ (ÏàòÎèô Î≥ÄÍ≤Ω Ïãú ÌîÑÎ¶¨ÏÖã Ï¥àÍ∏∞Ìôî)
            document.getElementById('kpiFilterMetricTertiary').addEventListener('change', e => {
                kpiFilter.tertiaryMetric = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterOperatorTertiary').addEventListener('change', e => {
                kpiFilter.tertiaryOperator = e.target.value;
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            document.getElementById('kpiFilterValueTertiary').addEventListener('input', e => {
                const formatted = formatNumberInput(e.target.value);
                e.target.value = formatted;
                kpiFilter.tertiaryValue = parseFormattedNumber(formatted);
                document.getElementById('kpiPresetSelect').value = '';
                document.getElementById('kpiPresetDescription').style.display = 'none';
                if (kpiFilter.enabled && kpiFilter.compoundLogic !== 'none' && kpiFilter.secondaryCompoundLogic !== 'none') {
                    updateDashboard();
                }
            });

            // Ï†ïÎ†¨ ÏÑ§Ï†ï Ïù¥Î≤§Ìä∏
            document.getElementById('sortMetric').addEventListener('change', e => {
                sortConfig.metric = e.target.value;
                updateDashboard();
            });

            document.querySelectorAll('input[name="sortOrder"]').forEach(radio => {
                radio.addEventListener('change', e => {
                    sortConfig.order = e.target.value;
                    updateDashboard();
                });
            });

            // Î™®Îã¨ Ï∞®Ìä∏ ÌÜ†Í∏Ä Î≤ÑÌäº Ïù¥Î≤§Ìä∏ (data-label-toggle Ïä§ÌÉÄÏùº)
            document.querySelectorAll('.modal-chart-toggle-group .data-label-toggle').forEach(btn => {
                btn.addEventListener('click', function() {
                    const checkboxId = this.dataset.chartToggle;
                    const checkbox = document.getElementById(checkboxId);
                    const toggleCheckbox = this.querySelector('.toggle-checkbox');

                    // ÌÜ†Í∏Ä ÏÉÅÌÉú Ï†ÑÌôò
                    checkbox.checked = !checkbox.checked;

                    if (checkbox.checked) {
                        this.classList.add('active');
                        toggleCheckbox.textContent = '‚úì';
                    } else {
                        this.classList.remove('active');
                        toggleCheckbox.textContent = '‚òê';
                    }

                    updateModalChart();
                });
            });

            // Î™®Îã¨ Îç∞Ïù¥ÌÑ∞ ÎùºÎ≤® ÌÜ†Í∏Ä Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            document.getElementById('modalDataLabelToggle').addEventListener('click', function() {
                showModalDataLabels = !showModalDataLabels;
                const toggleCheckbox = this.querySelector('.toggle-checkbox');

                if (showModalDataLabels) {
                    this.classList.add('active');
                    toggleCheckbox.textContent = '‚òë';
                } else {
                    this.classList.remove('active');
                    toggleCheckbox.textContent = '‚òê';
                }

                updateModalChart();
            });
        });
    </script>
</body>
</html>
