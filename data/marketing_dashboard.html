<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마케팅 대시보드</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* Berry Theme Colors */
            --primary-main: #673ab7;
            --primary-light: #ede7f6;
            --primary-dark: #5e35b1;
            --secondary-main: #2196f3;
            --secondary-light: #e3f2fd;
            --success-main: #00c853;
            --success-light: #b9f6ca;
            --warning-main: #ffab00;
            --warning-light: #fff8e1;
            --error-main: #ff1744;
            --error-light: #ffeaea;
            --grey-50: #fafafa;
            --grey-100: #f5f5f5;
            --grey-200: #eeeeee;
            --grey-300: #e0e0e0;
            --grey-500: #9e9e9e;
            --grey-700: #616161;
            --grey-900: #212121;
            --paper: #ffffff;
            --background: #f8fafc;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background);
            color: var(--grey-900);
            padding: 24px;
            line-height: 1.5;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* 헤더 */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--grey-900);
            margin: 0;
        }

        .header-subtitle {
            font-size: 14px;
            color: var(--grey-500);
            margin-top: 4px;
        }

        /* 카드 공통 스타일 */
        .card {
            background: var(--paper);
            border-radius: 12px;
            box-shadow: 0 2px 14px 0 rgba(32, 40, 45, 0.08);
            transition: box-shadow 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 4px 20px 0 rgba(32, 40, 45, 0.12);
        }

        /* 필터 섹션 */
        .filter-section {
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .filter-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-header::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--primary-main);
            border-radius: 2px;
        }

        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 160px;
            flex: 1;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 500;
            color: var(--grey-700);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px 14px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            background: var(--paper);
            color: var(--grey-900);
            transition: all 0.2s ease;
        }

        .filter-group select:hover,
        .filter-group input:hover {
            border-color: var(--primary-main);
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        /* 기간 선택 */
        .date-range {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .date-range span {
            color: var(--grey-500);
            font-weight: 500;
        }

        /* 뷰 타입 버튼 */
        .view-type-section {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }

        .view-btn {
            padding: 10px 24px;
            border: none;
            background: var(--paper);
            color: var(--grey-700);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .view-btn:hover {
            background: var(--primary-light);
            color: var(--primary-main);
        }

        .view-btn.active {
            background: var(--primary-main);
            color: white;
            box-shadow: 0 4px 12px rgba(103, 58, 183, 0.4);
        }

        /* KPI 섹션 - 2행 레이아웃 */
        .kpi-wrapper {
            margin-bottom: 24px;
        }

        .kpi-row {
            display: grid;
            gap: 16px;
            margin-bottom: 16px;
        }

        .kpi-row:last-child {
            margin-bottom: 0;
        }

        .kpi-row-primary {
            grid-template-columns: repeat(5, 1fr);
        }

        .kpi-row-secondary {
            grid-template-columns: repeat(4, 1fr);
        }

        .kpi-card {
            padding: 24px;
            position: relative;
            overflow: hidden;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--paper) 0%, var(--grey-50) 100%);
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            border-radius: 16px 0 0 16px;
        }

        /* Primary KPIs 색상 */
        .kpi-row-primary .kpi-card:nth-child(1)::before { background: linear-gradient(180deg, #673ab7 0%, #9c27b0 100%); }
        .kpi-row-primary .kpi-card:nth-child(2)::before { background: linear-gradient(180deg, #ffab00 0%, #ff8f00 100%); }
        .kpi-row-primary .kpi-card:nth-child(3)::before { background: linear-gradient(180deg, #2196f3 0%, #1976d2 100%); }
        .kpi-row-primary .kpi-card:nth-child(4)::before { background: linear-gradient(180deg, #ff9800 0%, #f57c00 100%); }
        .kpi-row-primary .kpi-card:nth-child(5)::before { background: linear-gradient(180deg, #00c853 0%, #00a152 100%); }

        /* Secondary KPIs 색상 */
        .kpi-row-secondary .kpi-card:nth-child(1)::before { background: linear-gradient(180deg, #00bcd4 0%, #0097a7 100%); }
        .kpi-row-secondary .kpi-card:nth-child(2)::before { background: linear-gradient(180deg, #e91e63 0%, #c2185b 100%); }
        .kpi-row-secondary .kpi-card:nth-child(3)::before { background: linear-gradient(180deg, #4caf50 0%, #388e3c 100%); }
        .kpi-row-secondary .kpi-card:nth-child(4)::before { background: linear-gradient(180deg, #9c27b0 0%, #7b1fa2 100%); }

        .kpi-card h3 {
            font-size: 11px;
            font-weight: 600;
            color: var(--grey-500);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .kpi-card .value {
            font-size: 32px;
            font-weight: 700;
            color: var(--grey-900);
            line-height: 1.1;
            margin-bottom: 4px;
        }

        .kpi-card .unit {
            font-size: 11px;
            color: var(--grey-500);
            font-weight: 500;
        }

        .kpi-card .trend-wrapper {
            margin-top: 12px;
        }

        .kpi-card .trend-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .kpi-card .trend {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .kpi-card .trend-pp {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            background: var(--grey-100);
            color: var(--grey-700);
        }

        .kpi-card .trend-pp.positive {
            color: var(--success-main);
            background: var(--success-light);
        }

        .kpi-card .trend-pp.negative {
            color: var(--error-main);
            background: var(--error-light);
        }

        .kpi-card .trend.up {
            color: var(--success-main);
            background: var(--success-light);
        }

        .kpi-card .trend.down {
            color: var(--error-main);
            background: var(--error-light);
        }

        .kpi-card .trend svg {
            width: 12px;
            height: 12px;
        }

        .kpi-card .trend-detail {
            font-size: 12px;
            color: var(--grey-500);
            margin-top: 8px;
            line-height: 1.4;
        }

        .kpi-card .trend-detail .prev-value {
            display: block;
            font-size: 20px;
            font-weight: 700;
            color: var(--grey-900);
            margin-top: 4px;
            line-height: 1.1;
        }

        .kpi-card .trend-detail .prev-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--grey-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* 차트 컨트롤 */
        .chart-controls {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chart-checkbox-group {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .chart-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: var(--grey-700);
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.2s ease;
            background: var(--grey-100);
        }

        .chart-checkbox:hover {
            background: var(--grey-200);
        }

        .chart-checkbox input {
            width: 16px;
            height: 16px;
            accent-color: var(--primary-main);
            cursor: pointer;
        }

        .chart-checkbox.cost { border-left: 3px solid #673ab7; }
        .chart-checkbox.cpm { border-left: 3px solid #ffab00; }
        .chart-checkbox.cpc { border-left: 3px solid #2196f3; }
        .chart-checkbox.roas { border-left: 3px solid #00c853; }

        /* 차트 섹션 */
        .chart-section {
            margin-bottom: 24px;
            padding: 24px;
        }

        .chart-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-header::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--secondary-main);
            border-radius: 2px;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* 데이터 테이블 */
        .table-section {
            overflow: hidden;
        }

        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--grey-200);
            font-size: 16px;
            font-weight: 600;
            color: var(--grey-900);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-header::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--success-main);
            border-radius: 2px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 14px 16px;
            text-align: right;
            font-size: 14px;
        }

        th {
            background: var(--grey-50);
            font-weight: 600;
            color: var(--grey-700);
            border-bottom: 2px solid var(--grey-200);
            position: sticky;
            top: 0;
            white-space: nowrap;
        }

        td {
            border-bottom: 1px solid var(--grey-100);
            color: var(--grey-900);
        }

        th:first-child,
        td:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            background: var(--paper);
            font-weight: 500;
        }

        th:first-child {
            background: var(--grey-50);
            z-index: 2;
        }

        tbody tr {
            transition: background 0.2s ease;
        }

        tbody tr:hover {
            background: var(--grey-50);
        }

        tbody tr:hover td:first-child {
            background: var(--grey-50);
        }

        .positive {
            color: var(--success-main);
            font-weight: 600;
        }

        .negative {
            color: var(--error-main);
            font-weight: 600;
        }

        /* 로딩 */
        .loading {
            text-align: center;
            padding: 60px 40px;
            color: var(--grey-500);
        }

        /* 합계 행 */
        .total-row {
            font-weight: 600;
            background: var(--primary-light) !important;
        }

        .total-row td {
            border-top: 2px solid var(--primary-main);
            color: var(--primary-dark);
        }

        .total-row td:first-child {
            background: var(--primary-light) !important;
        }

        /* 더 보기 버튼 */
        .show-more-container {
            padding: 16px 24px;
            text-align: center;
            border-top: 1px solid var(--grey-200);
        }

        .show-more-btn {
            padding: 10px 32px;
            background: var(--grey-100);
            color: var(--grey-700);
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .show-more-btn:hover {
            background: var(--primary-light);
            color: var(--primary-main);
            border-color: var(--primary-main);
        }

        .hidden-row {
            display: none;
        }

        /* 스크롤바 스타일 */
        .table-container::-webkit-scrollbar {
            height: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: var(--grey-100);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: var(--grey-300);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: var(--grey-500);
        }

        /* 반응형 */
        @media (max-width: 1200px) {
            .kpi-row-primary {
                grid-template-columns: repeat(3, 1fr);
            }
            .kpi-row-secondary {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 16px;
            }

            .filter-row {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .kpi-row-primary,
            .kpi-row-secondary {
                grid-template-columns: repeat(2, 1fr);
            }

            .kpi-card .value {
                font-size: 24px;
            }

            .view-type-section {
                flex-wrap: wrap;
            }

            .chart-container {
                height: 250px;
            }

            .chart-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (max-width: 480px) {
            .kpi-row-primary,
            .kpi-row-secondary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <div>
                <h1>마케팅 성과 대시보드</h1>
                <div class="header-subtitle">광고 캠페인 성과 분석 및 KPI 모니터링</div>
            </div>
        </div>

        <!-- 필터 섹션 -->
        <div class="filter-section card">
            <div class="filter-header">필터 설정</div>
            <div class="filter-row">
                <div class="filter-group">
                    <label>유형구분</label>
                    <select id="filterType">
                        <option value="">전체</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>브랜드명</label>
                    <select id="filterBrand">
                        <option value="">전체</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>상품명</label>
                    <select id="filterProduct">
                        <option value="">전체</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>추가 구분</label>
                    <select id="filterExtra">
                        <option value="">전체</option>
                    </select>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-group">
                    <label>기간 선택</label>
                    <div class="date-range">
                        <input type="date" id="startDate">
                        <span>~</span>
                        <input type="date" id="endDate">
                    </div>
                </div>
            </div>
        </div>

        <!-- 뷰 타입 선택 -->
        <div class="view-type-section">
            <button class="view-btn active" data-view="daily">일별</button>
            <button class="view-btn" data-view="weekly">주별</button>
            <button class="view-btn" data-view="monthly">월별</button>
        </div>

        <!-- KPI 카드 - 2행 레이아웃 -->
        <div class="kpi-wrapper">
            <!-- 상단 5개: 비용, CPM, CPC, CPA, ROAS -->
            <div class="kpi-row kpi-row-primary">
                <div class="kpi-card card">
                    <h3>총 비용</h3>
                    <div class="value" id="totalCost">-</div>
                    <div class="unit">원</div>
                    <div class="trend-wrapper" id="trendCostWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendCost">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendCostPP"></span>
                        </div>
                        <div class="trend-detail" id="trendCostDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>CPM</h3>
                    <div class="value" id="avgCPM">-</div>
                    <div class="unit">원</div>
                    <div class="trend-wrapper" id="trendCPMWrapper">
                        <div class="trend-row">
                            <div class="trend down" id="trendCPM">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendCPMPP"></span>
                        </div>
                        <div class="trend-detail" id="trendCPMDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>CPC</h3>
                    <div class="value" id="avgCPC">-</div>
                    <div class="unit">원</div>
                    <div class="trend-wrapper" id="trendCPCWrapper">
                        <div class="trend-row">
                            <div class="trend down" id="trendCPC">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendCPCPP"></span>
                        </div>
                        <div class="trend-detail" id="trendCPCDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>CPA</h3>
                    <div class="value" id="avgCPA">-</div>
                    <div class="unit">원</div>
                    <div class="trend-wrapper" id="trendCPAWrapper">
                        <div class="trend-row">
                            <div class="trend down" id="trendCPA">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendCPAPP"></span>
                        </div>
                        <div class="trend-detail" id="trendCPADetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>ROAS</h3>
                    <div class="value" id="totalROAS">-</div>
                    <div class="unit"></div>
                    <div class="trend-wrapper" id="trendROASWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendROAS">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendROASPP"></span>
                        </div>
                        <div class="trend-detail" id="trendROASDetail"></div>
                    </div>
                </div>
            </div>
            <!-- 하단 4개: 노출, 클릭, 전환수, 전환값 -->
            <div class="kpi-row kpi-row-secondary">
                <div class="kpi-card card">
                    <h3>총 노출</h3>
                    <div class="value" id="totalImpressions">-</div>
                    <div class="unit">회</div>
                    <div class="trend-wrapper" id="trendImpressionsWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendImpressions">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendImpressionsPP"></span>
                        </div>
                        <div class="trend-detail" id="trendImpressionsDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>총 클릭</h3>
                    <div class="value" id="totalClicks">-</div>
                    <div class="unit">회</div>
                    <div class="trend-wrapper" id="trendClicksWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendClicks">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendClicksPP"></span>
                        </div>
                        <div class="trend-detail" id="trendClicksDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>총 전환수</h3>
                    <div class="value" id="totalConversions">-</div>
                    <div class="unit">건</div>
                    <div class="trend-wrapper" id="trendConversionsWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendConversions">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendConversionsPP"></span>
                        </div>
                        <div class="trend-detail" id="trendConversionsDetail"></div>
                    </div>
                </div>
                <div class="kpi-card card">
                    <h3>총 전환값</h3>
                    <div class="value" id="totalConversionValue">-</div>
                    <div class="unit">원</div>
                    <div class="trend-wrapper" id="trendConversionValueWrapper">
                        <div class="trend-row">
                            <div class="trend up" id="trendConversionValue">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14l5-5 5 5z"/></svg>
                                <span>0%</span>
                            </div>
                            <span class="trend-pp" id="trendConversionValuePP"></span>
                        </div>
                        <div class="trend-detail" id="trendConversionValueDetail"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 차트 섹션 -->
        <div class="chart-section card">
            <div class="chart-header">성과 지표 추이</div>
            <div class="chart-controls">
                <div class="chart-checkbox-group">
                    <label class="chart-checkbox cost">
                        <input type="checkbox" id="chartCost" checked>
                        <span>비용</span>
                    </label>
                    <label class="chart-checkbox cpm">
                        <input type="checkbox" id="chartCPM">
                        <span>CPM</span>
                    </label>
                    <label class="chart-checkbox cpc">
                        <input type="checkbox" id="chartCPC">
                        <span>CPC</span>
                    </label>
                    <label class="chart-checkbox roas">
                        <input type="checkbox" id="chartROAS" checked>
                        <span>ROAS</span>
                    </label>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="trendChart"></canvas>
            </div>
        </div>

        <!-- 데이터 테이블 -->
        <div class="table-section card">
            <div class="table-header">상세 데이터</div>
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>기간</th>
                            <th>비용</th>
                            <th>노출</th>
                            <th>CPM</th>
                            <th>클릭</th>
                            <th>CPC</th>
                            <th>전환수</th>
                            <th>CPA</th>
                            <th>전환값</th>
                            <th>ROAS</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td colspan="10" class="loading">데이터를 불러오는 중...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="show-more-container" id="showMoreContainer" style="display: none;">
                <button class="show-more-btn" id="showMoreBtn">더 보기 (<span id="hiddenCount">0</span>개)</button>
            </div>
            <div class="show-more-container" id="collapseContainer" style="display: none;">
                <button class="show-more-btn" id="collapseBtn">접기</button>
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let allData = [];
        let currentView = 'daily';
        let filters = {
            type: '',
            brand: '',
            product: '',
            extra: '',
            startDate: '',
            endDate: ''
        };
        let trendChart = null;

        // CSV 파일 목록
        const csvFiles = [
            'raw/2025-01.csv',
            'raw/2025-02.csv',
            'raw/2025-03.csv',
            'raw/2025-04.csv',
            'raw/2025-05.csv',
            'raw/2025-06.csv',
            'raw/2025-07.csv',
            'raw/2025-08.csv',
            'raw/2025-09.csv',
            'raw/2025-10.csv',
            'raw/2025-11.csv'
        ];

        // CSV 파싱 함수 (RFC 4180 호환)
        function parseCSV(text) {
            const lines = text.trim().split('\n');

            // RFC 4180 호환 CSV 파싱
            function parseLine(line) {
                const result = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];

                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            // 연속된 따옴표는 이스케이프된 따옴표
                            current += '"';
                            i++; // 다음 따옴표 건너뛰기
                        } else {
                            // 따옴표 시작/종료
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        // 따옴표 밖의 쉼표는 구분자
                        result.push(current);
                        current = '';
                    } else {
                        current += char;
                    }
                }

                // 마지막 필드 추가
                result.push(current);
                return result;
            }

            const headers = parseLine(lines[0]).map(h => h.trim());

            return lines.slice(1).map(line => {
                const values = parseLine(line);
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = values[index] ? values[index].trim() : '';
                });
                return obj;
            });
        }

        // 데이터 로드
        async function loadData() {
            const promises = csvFiles.map(file =>
                fetch(file)
                    .then(response => {
                        if (!response.ok) throw new Error(`Failed to load ${file}`);
                        return response.text();
                    })
                    .then(text => parseCSV(text))
                    .catch(err => {
                        console.warn(`Could not load ${file}:`, err);
                        return [];
                    })
            );

            const results = await Promise.all(promises);
            allData = results.flat();

            // unique 값으로 필터 옵션 설정
            populateFilters();

            // 날짜 범위 설정
            setDateRange();

            // 초기 데이터 표시
            updateDashboard();
        }

        // 필터 옵션 설정
        function populateFilters() {
            const types = [...new Set(allData.map(d => d['유형구분']))].filter(Boolean).sort();
            const brands = [...new Set(allData.map(d => d['브랜드명']))].filter(Boolean).sort();
            const products = [...new Set(allData.map(d => d['상품명']))].filter(Boolean).sort();
            const extras = [...new Set(allData.map(d => d['추가 구분']))].filter(Boolean).sort();

            populateSelect('filterType', types);
            populateSelect('filterBrand', brands);
            populateSelect('filterProduct', products);
            populateSelect('filterExtra', extras);
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt;
                option.textContent = opt;
                select.appendChild(option);
            });
        }

        // 날짜 범위 설정
        function setDateRange() {
            const dates = allData
                .map(d => d['일 구분'])
                .filter(Boolean)
                .map(d => new Date(d))
                .filter(d => !isNaN(d));

            if (dates.length > 0) {
                const minDate = new Date(Math.min(...dates));
                const maxDate = new Date(Math.max(...dates));

                document.getElementById('startDate').value = formatDateForInput(minDate);
                document.getElementById('endDate').value = formatDateForInput(maxDate);

                filters.startDate = formatDateForInput(minDate);
                filters.endDate = formatDateForInput(maxDate);
            }
        }

        function formatDateForInput(date) {
            return date.toISOString().split('T')[0];
        }

        // 데이터 필터링
        function filterData() {
            return allData.filter(row => {
                // 필터 조건 확인
                if (filters.type && row['유형구분'] !== filters.type) return false;
                if (filters.brand && row['브랜드명'] !== filters.brand) return false;
                if (filters.product && row['상품명'] !== filters.product) return false;
                if (filters.extra && row['추가 구분'] !== filters.extra) return false;

                // 날짜 범위 확인
                if (filters.startDate || filters.endDate) {
                    const rowDate = new Date(row['일 구분']);
                    if (isNaN(rowDate)) return false;

                    if (filters.startDate && rowDate < new Date(filters.startDate)) return false;
                    if (filters.endDate && rowDate > new Date(filters.endDate)) return false;
                }

                return true;
            });
        }

        // 데이터 집계
        function aggregateData(data) {
            const groupKey = {
                'daily': '일 구분',
                'weekly': '주 구분',
                'monthly': '월 구분'
            }[currentView];

            const groups = {};

            data.forEach(row => {
                const key = row[groupKey];
                if (!key) return;

                if (!groups[key]) {
                    groups[key] = {
                        period: key,
                        비용: 0,
                        노출: 0,
                        클릭: 0,
                        전환수: 0,
                        전환값: 0
                    };
                }

                groups[key].비용 += parseFloat(row['비용']) || 0;
                groups[key].노출 += parseFloat(row['노출']) || 0;
                groups[key].클릭 += parseFloat(row['클릭']) || 0;
                groups[key].전환수 += parseFloat(row['전환수']) || 0;
                groups[key].전환값 += parseFloat(row['전환값']) || 0;
            });

            // KPI 계산
            return Object.values(groups).map(g => ({
                ...g,
                CPM: g.노출 > 0 ? (g.비용 / g.노출 * 1000) : 0,
                CPC: g.클릭 > 0 ? (g.비용 / g.클릭) : 0,
                CPA: g.전환수 > 0 ? (g.비용 / g.전환수) : 0,
                ROAS: g.비용 > 0 ? (g.전환값 / g.비용 * 100) : 0
            })).sort((a, b) => {
                // 날짜순 정렬
                const dateA = new Date(a.period.replace(/\. /g, '-').replace(/\./g, ''));
                const dateB = new Date(b.period.replace(/\. /g, '-').replace(/\./g, ''));
                return dateA - dateB;
            });
        }

        // 대시보드 업데이트
        function updateDashboard() {
            const filteredData = filterData();
            const aggregatedData = aggregateData(filteredData);

            // KPI 업데이트
            updateKPIs(aggregatedData);

            // 차트 업데이트
            updateChart(aggregatedData);

            // 테이블 업데이트
            updateTable(aggregatedData);
        }

        // 차트 데이터 저장
        let currentChartData = [];

        // 차트 업데이트
        function updateChart(data) {
            currentChartData = data;
            renderChart();
        }

        // 차트 렌더링
        function renderChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');

            // 기존 차트 제거
            if (trendChart) {
                trendChart.destroy();
            }

            const data = currentChartData;
            const labels = data.map(d => d.period);

            // 체크박스 상태 확인
            const showCost = document.getElementById('chartCost').checked;
            const showCPM = document.getElementById('chartCPM').checked;
            const showCPC = document.getElementById('chartCPC').checked;
            const showROAS = document.getElementById('chartROAS').checked;

            // CPM/CPC가 비용과 함께 표시될 때 오른쪽 Y축 사용
            const useRightAxisForCPMCPC = showCost && (showCPM || showCPC);

            const datasets = [];

            if (showCost) {
                datasets.push({
                    label: '비용',
                    data: data.map(d => d.비용),
                    backgroundColor: 'rgba(103, 58, 183, 0.7)',
                    borderColor: 'rgba(103, 58, 183, 1)',
                    borderWidth: 1,
                    borderRadius: 4,
                    yAxisID: 'y',
                    order: 4
                });
            }

            if (showCPM) {
                datasets.push({
                    label: 'CPM',
                    data: data.map(d => d.CPM),
                    type: 'line',
                    borderColor: 'rgba(255, 171, 0, 1)',
                    backgroundColor: 'rgba(255, 171, 0, 0.1)',
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(255, 171, 0, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 3,
                    pointHoverRadius: 5,
                    fill: false,
                    tension: 0.4,
                    yAxisID: useRightAxisForCPMCPC ? 'y1' : 'y',
                    order: 3
                });
            }

            if (showCPC) {
                datasets.push({
                    label: 'CPC',
                    data: data.map(d => d.CPC),
                    type: 'line',
                    borderColor: 'rgba(33, 150, 243, 1)',
                    backgroundColor: 'rgba(33, 150, 243, 0.1)',
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(33, 150, 243, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 3,
                    pointHoverRadius: 5,
                    fill: false,
                    tension: 0.4,
                    yAxisID: useRightAxisForCPMCPC ? 'y1' : 'y',
                    order: 2
                });
            }

            if (showROAS) {
                datasets.push({
                    label: 'ROAS (%)',
                    data: data.map(d => d.ROAS),
                    type: 'line',
                    borderColor: 'rgba(0, 200, 83, 1)',
                    backgroundColor: 'rgba(0, 200, 83, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(0, 200, 83, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y1',
                    order: 1
                });
            }

            // 오른쪽 Y축 표시 여부와 타이틀 결정
            const showY1 = showROAS || useRightAxisForCPMCPC;
            let y1Title = '';
            if (showROAS && useRightAxisForCPMCPC) {
                y1Title = 'CPM/CPC/ROAS';
            } else if (showROAS) {
                y1Title = 'ROAS (%)';
            } else if (useRightAxisForCPMCPC) {
                y1Title = 'CPM/CPC (원)';
            }

            trendChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            align: 'end',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(33, 33, 33, 0.9)',
                            titleFont: {
                                family: "'Inter', sans-serif",
                                size: 13
                            },
                            bodyFont: {
                                family: "'Inter', sans-serif",
                                size: 12
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'ROAS (%)') {
                                        label += Math.round(context.parsed.y) + '%';
                                    } else {
                                        label += formatNumber(context.parsed.y) + '원';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 11
                                },
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: '금액 (원)',
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 12
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 11
                                },
                                callback: function(value) {
                                    if (value >= 1000000) {
                                        return (value / 1000000).toFixed(1) + 'M';
                                    } else if (value >= 1000) {
                                        return (value / 1000).toFixed(0) + 'K';
                                    }
                                    return value;
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: showY1,
                            position: 'right',
                            title: {
                                display: true,
                                text: y1Title,
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 12
                                }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                font: {
                                    family: "'Inter', sans-serif",
                                    size: 11
                                },
                                callback: function(value) {
                                    if (showROAS && !useRightAxisForCPMCPC) {
                                        return value + '%';
                                    } else if (useRightAxisForCPMCPC && !showROAS) {
                                        return formatNumber(value);
                                    }
                                    return value;
                                }
                            }
                        }
                    }
                }
            });
        }

        // KPI 업데이트
        function updateKPIs(data) {
            const totals = data.reduce((acc, row) => {
                acc.비용 += row.비용;
                acc.노출 += row.노출;
                acc.클릭 += row.클릭;
                acc.전환수 += row.전환수;
                acc.전환값 += row.전환값;
                return acc;
            }, { 비용: 0, 노출: 0, 클릭: 0, 전환수: 0, 전환값: 0 });

            const totalCPM = totals.노출 > 0 ? (totals.비용 / totals.노출 * 1000) : 0;
            const totalCPC = totals.클릭 > 0 ? (totals.비용 / totals.클릭) : 0;
            const totalCPA = totals.전환수 > 0 ? (totals.비용 / totals.전환수) : 0;
            const totalROASValue = totals.비용 > 0 ? (totals.전환값 / totals.비용 * 100) : 0;

            document.getElementById('totalCost').textContent = formatNumber(totals.비용);
            document.getElementById('totalImpressions').textContent = formatNumber(totals.노출);
            document.getElementById('avgCPM').textContent = formatNumber(totalCPM);
            document.getElementById('totalClicks').textContent = formatNumber(totals.클릭);
            document.getElementById('avgCPC').textContent = formatNumber(totalCPC);
            document.getElementById('totalConversions').textContent = formatNumber(totals.전환수);
            document.getElementById('avgCPA').textContent = formatNumber(totalCPA);
            document.getElementById('totalConversionValue').textContent = formatNumber(totals.전환값);
            document.getElementById('totalROAS').textContent = formatROAS(totalROASValue);

            // 증감율 계산 (마지막 기간 vs 직전 기간 비교)
            // 테이블 최하단이 최신 데이터, 그 위가 이전 데이터
            if (data.length >= 2) {
                // 마지막 기간과 직전 기간 (테이블 순서 기준)
                const lastPeriodData = data[data.length - 1];
                const prevPeriodData = data[data.length - 2];

                const calcMetrics = (row) => {
                    return {
                        비용: row.비용,
                        노출: row.노출,
                        클릭: row.클릭,
                        전환수: row.전환수,
                        전환값: row.전환값,
                        CPM: row.노출 > 0 ? (row.비용 / row.노출 * 1000) : 0,
                        CPC: row.클릭 > 0 ? (row.비용 / row.클릭) : 0,
                        CPA: row.전환수 > 0 ? (row.비용 / row.전환수) : 0,
                        ROAS: row.비용 > 0 ? (row.전환값 / row.비용 * 100) : 0
                    };
                };

                const first = calcMetrics(prevPeriodData);  // 이전 기간
                const second = calcMetrics(lastPeriodData); // 현재 기간 (마지막)

                const calcChange = (newVal, oldVal) => {
                    if (oldVal === 0) return newVal > 0 ? 100 : 0;
                    return ((newVal - oldVal) / oldVal * 100);
                };

                // 퍼센트 포인트 계산 (ROAS용)
                const calcPP = (newVal, oldVal) => {
                    return newVal - oldVal;
                };

                // 증감율 업데이트 함수
                const updateTrend = (id, change, oldValue, newValue, isGoodWhenUp = true, isPercentage = false) => {
                    const el = document.getElementById(id);
                    const ppEl = document.getElementById(id + 'PP');
                    const detailEl = document.getElementById(id + 'Detail');
                    if (!el) return;

                    const isUp = change >= 0;
                    const isGood = isGoodWhenUp ? isUp : !isUp;

                    el.className = `trend ${isGood ? 'up' : 'down'}`;
                    el.innerHTML = `
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="${isUp ? 'M7 14l5-5 5 5z' : 'M7 10l5 5 5-5z'}"/>
                        </svg>
                        <span>${Math.abs(Math.round(change))}%</span>
                    `;

                    // %p 수치를 트렌드 옆에 병렬로 표시
                    if (ppEl) {
                        if (isPercentage) {
                            // ROAS의 경우: 퍼센트 포인트 계산
                            const pp = newValue - oldValue;
                            const ppSign = pp >= 0 ? '+' : '';
                            ppEl.textContent = `${ppSign}${Math.round(pp)}%p`;
                            ppEl.className = `trend-pp ${pp >= 0 ? 'positive' : 'negative'}`;
                        } else {
                            // 일반 숫자의 경우: 차이값 표시
                            const diff = newValue - oldValue;
                            const diffSign = diff >= 0 ? '+' : '';
                            ppEl.textContent = `${diffSign}${formatNumber(diff)}`;
                            ppEl.className = `trend-pp ${isGood ? 'positive' : 'negative'}`;
                        }
                    }

                    // 상세 정보 업데이트 (이전 값만)
                    if (detailEl) {
                        let detailHTML = '';
                        if (isPercentage) {
                            detailHTML = `
                                <span class="prev-label">이전</span>
                                <span class="prev-value">${Math.round(oldValue)}%</span>
                            `;
                        } else {
                            detailHTML = `
                                <span class="prev-label">이전</span>
                                <span class="prev-value">${formatNumber(oldValue)}</span>
                            `;
                        }
                        detailEl.innerHTML = detailHTML;
                    }
                };

                // 비용, 노출, 클릭, 전환수, 전환값은 증가가 좋음
                updateTrend('trendCost', calcChange(second.비용, first.비용), first.비용, second.비용, true, false);
                updateTrend('trendImpressions', calcChange(second.노출, first.노출), first.노출, second.노출, true, false);
                updateTrend('trendClicks', calcChange(second.클릭, first.클릭), first.클릭, second.클릭, true, false);
                updateTrend('trendConversions', calcChange(second.전환수, first.전환수), first.전환수, second.전환수, true, false);
                updateTrend('trendConversionValue', calcChange(second.전환값, first.전환값), first.전환값, second.전환값, true, false);
                updateTrend('trendROAS', calcChange(second.ROAS, first.ROAS), first.ROAS, second.ROAS, true, true);

                // CPM, CPC, CPA는 감소가 좋음
                updateTrend('trendCPM', calcChange(second.CPM, first.CPM), first.CPM, second.CPM, false, false);
                updateTrend('trendCPC', calcChange(second.CPC, first.CPC), first.CPC, second.CPC, false, false);
                updateTrend('trendCPA', calcChange(second.CPA, first.CPA), first.CPA, second.CPA, false, false);
            }
        }

        // 테이블 업데이트
        const TABLE_ROW_LIMIT = 10;
        let isTableExpanded = false;

        function updateTable(data) {
            const tbody = document.getElementById('tableBody');
            const showMoreContainer = document.getElementById('showMoreContainer');
            const hiddenCountSpan = document.getElementById('hiddenCount');

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="loading">데이터가 없습니다.</td></tr>';
                showMoreContainer.style.display = 'none';
                return;
            }

            // 합계 계산
            const totals = data.reduce((acc, row) => {
                acc.비용 += row.비용;
                acc.노출 += row.노출;
                acc.클릭 += row.클릭;
                acc.전환수 += row.전환수;
                acc.전환값 += row.전환값;
                return acc;
            }, { 비용: 0, 노출: 0, 클릭: 0, 전환수: 0, 전환값: 0 });

            const hiddenCount = Math.max(0, data.length - TABLE_ROW_LIMIT);

            let html = data.map((row, index) => `
                <tr class="${!isTableExpanded && index >= TABLE_ROW_LIMIT ? 'hidden-row' : ''}">
                    <td>${row.period}</td>
                    <td>${formatNumber(row.비용)}</td>
                    <td>${formatNumber(row.노출)}</td>
                    <td>${formatNumber(row.CPM)}</td>
                    <td>${formatNumber(row.클릭)}</td>
                    <td>${formatNumber(row.CPC)}</td>
                    <td>${formatNumber(row.전환수)}</td>
                    <td>${formatNumber(row.CPA)}</td>
                    <td>${formatNumber(row.전환값)}</td>
                    <td class="${row.ROAS >= 100 ? 'positive' : 'negative'}">${formatROAS(row.ROAS)}</td>
                </tr>
            `).join('');

            // 합계 행 추가
            const totalCPM = totals.노출 > 0 ? (totals.비용 / totals.노출 * 1000) : 0;
            const totalCPC = totals.클릭 > 0 ? (totals.비용 / totals.클릭) : 0;
            const totalCPA = totals.전환수 > 0 ? (totals.비용 / totals.전환수) : 0;
            const totalROAS = totals.비용 > 0 ? (totals.전환값 / totals.비용 * 100) : 0;

            html += `
                <tr class="total-row">
                    <td>합계</td>
                    <td>${formatNumber(totals.비용)}</td>
                    <td>${formatNumber(totals.노출)}</td>
                    <td>${formatNumber(totalCPM)}</td>
                    <td>${formatNumber(totals.클릭)}</td>
                    <td>${formatNumber(totalCPC)}</td>
                    <td>${formatNumber(totals.전환수)}</td>
                    <td>${formatNumber(totalCPA)}</td>
                    <td>${formatNumber(totals.전환값)}</td>
                    <td class="${totalROAS >= 100 ? 'positive' : 'negative'}">${formatROAS(totalROAS)}</td>
                </tr>
            `;

            tbody.innerHTML = html;

            // 더 보기 버튼 표시/숨김
            if (hiddenCount > 0 && !isTableExpanded) {
                showMoreContainer.style.display = 'block';
                hiddenCountSpan.textContent = hiddenCount;
            } else {
                showMoreContainer.style.display = 'none';
            }
        }

        // 더 보기 버튼 클릭 핸들러
        function expandTableRows() {
            isTableExpanded = true;
            const hiddenRows = document.querySelectorAll('#tableBody .hidden-row');
            const showMoreContainer = document.getElementById('showMoreContainer');
            const collapseContainer = document.getElementById('collapseContainer');

            hiddenRows.forEach(row => {
                row.classList.remove('hidden-row');
            });

            showMoreContainer.style.display = 'none';
            collapseContainer.style.display = 'block';
        }

        // 접기 버튼 클릭 핸들러
        function collapseTableRows() {
            isTableExpanded = false;
            const tbody = document.getElementById('tableBody');
            const rows = tbody.querySelectorAll('tr:not(.total-row)');
            const showMoreContainer = document.getElementById('showMoreContainer');
            const collapseContainer = document.getElementById('collapseContainer');
            const hiddenCountSpan = document.getElementById('hiddenCount');

            rows.forEach((row, index) => {
                if (index >= TABLE_ROW_LIMIT) {
                    row.classList.add('hidden-row');
                }
            });

            const hiddenCount = Math.max(0, rows.length - TABLE_ROW_LIMIT);
            if (hiddenCount > 0) {
                showMoreContainer.style.display = 'block';
                hiddenCountSpan.textContent = hiddenCount;
            }
            collapseContainer.style.display = 'none';
        }

        // 숫자 포맷 - #,###;;-;@ 형식 (0은 '-'로 표시)
        function formatNumber(num) {
            if (num === 0 || num === null || num === undefined) return '-';
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // ROAS 포맷 - 0%;;-;@ 형식 (0은 '-'로 표시, %는 정수)
        function formatROAS(num) {
            if (num === 0 || num === null || num === undefined) return '-';
            return Math.round(num) + '%';
        }

        // 이벤트 리스너
        document.addEventListener('DOMContentLoaded', () => {
            loadData();

            // 필터 변경 이벤트
            document.getElementById('filterType').addEventListener('change', e => {
                filters.type = e.target.value;
                updateDashboard();
            });

            document.getElementById('filterBrand').addEventListener('change', e => {
                filters.brand = e.target.value;
                updateDashboard();
            });

            document.getElementById('filterProduct').addEventListener('change', e => {
                filters.product = e.target.value;
                updateDashboard();
            });

            document.getElementById('filterExtra').addEventListener('change', e => {
                filters.extra = e.target.value;
                updateDashboard();
            });

            document.getElementById('startDate').addEventListener('change', e => {
                filters.startDate = e.target.value;
                updateDashboard();
            });

            document.getElementById('endDate').addEventListener('change', e => {
                filters.endDate = e.target.value;
                updateDashboard();
            });

            // 뷰 타입 버튼
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentView = btn.dataset.view;
                    updateDashboard();
                });
            });

            // 차트 체크박스 이벤트
            ['chartCost', 'chartCPM', 'chartCPC', 'chartROAS'].forEach(id => {
                document.getElementById(id).addEventListener('change', () => {
                    renderChart();
                });
            });

            // 더 보기 버튼 이벤트
            document.getElementById('showMoreBtn').addEventListener('click', expandTableRows);

            // 접기 버튼 이벤트
            document.getElementById('collapseBtn').addEventListener('click', collapseTableRows);
        });
    </script>
</body>
</html>
